---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(xts)
library(lubridate)
```

```{r}
# data prep
# decided not to convert from factor..

dates <- c(
1947,1947.25,1947.5,1947.75,1948,1948.25,1948.5,1948.75,1949,1949.25,1949.5,
1949.75,1950,1950.25,1950.5,1950.75,1951,1951.25,1951.5,1951.75,1952,1952.25,
1952.5,1952.75,1953,1953.25,1953.5,1953.75,1954,1954.25,1954.5,1954.75,1955,
1955.25,1955.5,1955.75,1956,1956.25,1956.5,1956.75,1957,1957.25,1957.5,1957.75,
1958,1958.25,1958.5,1958.75,1959,1959.25,1959.5,1959.75,1960,1960.25,1960.5,
1960.75,1961,1961.25,1961.5,1961.75,1962,1962.25,1962.5,1962.75,1963,1963.25,
1963.5,1963.75,1964,1964.25,1964.5,1964.75,1965,1965.25,1965.5,1965.75,1966,
1966.25,1966.5,1966.75,1967,1967.25,1967.5,1967.75,1968,1968.25,1968.5,1968.75,
1969,1969.25,1969.5,1969.75,1970,1970.25,1970.5,1970.75,1971,1971.25,1971.5,
1971.75,1972,1972.25,1972.5,1972.75,1973,1973.25,1973.5,1973.75,1974,1974.25,
1974.5,1974.75,1975,1975.25,1975.5,1975.75,1976,1976.25,1976.5,1976.75,1977,
1977.25,1977.5,1977.75,1978,1978.25,1978.5,1978.75,1979,1979.25,1979.5,1979.75,
1980,1980.25,1980.5,1980.75,1981,1981.25,1981.5,1981.75,1982,1982.25,1982.5,
1982.75,1983,1983.25,1983.5,1983.75,1984,1984.25,1984.5,1984.75,1985,1985.25,
1985.5,1985.75,1986,1986.25,1986.5,1986.75,1987,1987.25,1987.5,1987.75,1988,
1988.25,1988.5,1988.75,1989,1989.25,1989.5,1989.75,1990,1990.25,1990.5,1990.75,
1991,1991.25,1991.5,1991.75,1992,1992.25,1992.5,1992.75,1993,1993.25,1993.5,
1993.75,1994,1994.25,1994.5,1994.75,1995,1995.25,1995.5,1995.75,1996,1996.25,
1996.5,1996.75,1997,1997.25,1997.5,1997.75,1998,1998.25,1998.5,1998.75,1999,
1999.25,1999.5,1999.75,2000,2000.25,2000.5,2000.75,2001,2001.25,2001.5,2001.75,
2002,2002.25,2002.5,2002.75,2003,2003.25,2003.5,2003.75,2004,2004.25,2004.5,
2004.75,2005,2005.25,2005.5,2005.75,2006,2006.25,2006.5,2006.75,2007,2007.25,
2007.5,2007.75,2008,2008.25,2008.5,2008.75,2009,2009.25,2009.5,2009.75,2010,
2010.25,2010.5,2010.75,2011,2011.25,2011.5,2011.75,2012,2012.25,2012.5,2012.75,
2013,2013.25,2013.5,2013.75,2014,2014.25,2014.5,2014.75,2015,2015.25,2015.5,
2015.75,2016,2016.25,2016.5
)
class(dates) <- "yearqtr"
str(dates)
```

```{r}
gdp_billions <- c(
243.1,246.3,250.1,260.3,266.2,272.9,279.5,280.7,275.4,NA,NA,271,281.2,NA,308.5,
320.3,336.4,NA,351.8,356.6,NA,NA,NA,381.2,388.5,NA,NA,NA,NA,NA,391.6,400.3,
413.8,422.2,430.9,NA,NA,446.8,452,461.3,470.6,472.8,NA,NA,NA,NA,486.7,500.4,
511.1,524.2,525.2,529.3,543.3,542.7,546,541.1,545.9,557.4,568.2,581.6,595.2,
602.6,609.6,NA,NA,NA,NA,654.8,671.1,680.8,692.8,698.4,719.2,732.4,NA,NA,NA,NA,
820.8,834.9,846,851.1,866.6,883.2,NA,936.3,952.3,NA,995.4,1011.4,1032,1040.7,
1053.5,1070.1,NA,1091.5,1137.8,1159.4,1180.3,1193.6,1233.8,NA,NA,1332,1380.7,
1417.6,1436.8,1479.1,1494.7,1534.2,NA,1603,NA,NA,1713.8,1765.9,1824.5,1856.9,
1890.5,1938.4,1992.5,2060.2,2122.4,NA,NA,2336.6,2398.9,2482.2,2531.6,NA,2670.4,
2730.7,2796.5,2799.9,2860,NA,3131.8,3167.3,3261.2,3283.5,3273.8,NA,NA,NA,3480.3,
3583.8,3692.3,3796.1,NA,NA,NA,NA,4237,4302.3,4394.6,4453.1,NA,NA,NA,NA,4736.2,
4821.5,4900.5,5022.7,NA,NA,NA,NA,NA,NA,5711.6,5763.4,5890.8,NA,NA,NA,NA,NA,NA,
NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,7545.3,7604.9,7706.5,7799.5,7893.1,
8061.5,8159,8287.1,8402.1,8551.9,8691.8,8788.3,8889.7,8994.7,9146.5,9325.7,
9447.1,NA,9712.3,9926.1,10031,10278.3,10357.4,10472.3,10508.1,10638.4,10639.5,
10701.3,NA,NA,11037.1,11103.8,11230.1,11370.7,11625.1,11816.8,11988.4,12181.4,
12367.7,12562.2,12813.7,12974.1,13205.4,13381.6,13648.9,NA,13908.5,14066.4,
14233.2,14422.3,14569.7,14685.3,14668.4,14813,14843,14549.9,14383.9,14340.4,
14384.1,14566.5,14681.1,14888.6,15057.7,15230.2,NA,15460.9,15587.1,15785.3,
15973.9,16121.9,16227.9,16297.3,16475.4,16541.4,16749.3,16999.9,17025.2,17285.6,
17569.4,17692.2,NA,17998.3,18141.9,18222.8,18281.6,18450.1,18651.2
)
```

```{r}
gdp <- data.frame(gdp_billions = gdp_billions, date = dates)

# Convert GDP data to xts
gdp_xts <- as.xts(gdp$gdp_billions, order.by = gdp$date)

# Plot GDP data over time
plot.xts(gdp_xts)
```


```{r eval=FALSE}
# Get a summary of your GDP data
#summary(gdp)

# Convert GDP date column to time object
#gdp$date <- as.yearqtr(gdp$date)

# Convert GDP data to xts
#gdp_xts <- as.xts(gdp[, -1], order.by = gdp$date)

# Plot GDP data over time
#plot.xts(gdp_xts)

```

```{r}
# Fill NAs in gdp_xts with the last observation carried forward
gdp_locf <- na.locf(gdp_xts)

# Fill NAs in gdp_xts with the next observation carried backward 
gdp_nocb <- na.locf(gdp_xts, fromLast = TRUE)

# Produce a plot for each of your new xts objects
par(mfrow = c(2,1))
plot.xts(gdp_locf, major.format = "%Y")
plot.xts(gdp_nocb, major.format = "%Y")

# Query for GDP in 1993 in both gdp_locf and gdp_nocb
gdp_locf["1993"]
gdp_nocb["1993"]

```

```{r}
# Fill NAs in gdp_xts using linear approximation
gdp_approx <- na.approx(gdp_xts)

# Plot your new xts object
plot.xts(gdp_approx, major.format = "%Y")
  
# Query for GDP in 1993 in gdp_approx
gdp_approx["1993"]

```

```{r}
# data prep
#> index(unemployment)

dates <- c(
1976,1976.083,1976.167,1976.25,1976.333,1976.417,1976.5,1976.583,1976.667,
1976.75,1976.833,1976.917,1977,1977.083,1977.167,1977.25,1977.333,1977.417,
1977.5,1977.583,1977.667,1977.75,1977.833,1977.917,1978,1978.083,1978.167,
1978.25,1978.333,1978.417,1978.5,1978.583,1978.667,1978.75,1978.833,1978.917,
1979,1979.083,1979.167,1979.25,1979.333,1979.417,1979.5,1979.583,1979.667,
1979.75,1979.833,1979.917,1980,1980.083,1980.167,1980.25,1980.333,1980.417,
1980.5,1980.583,1980.667,1980.75,1980.833,1980.917,1981,1981.083,1981.167,
1981.25,1981.333,1981.417,1981.5,1981.583,1981.667,1981.75,1981.833,1981.917,
1982,1982.083,1982.167,1982.25,1982.333,1982.417,1982.5,1982.583,1982.667,
1982.75,1982.833,1982.917,1983,1983.083,1983.167,1983.25,1983.333,1983.417,
1983.5,1983.583,1983.667,1983.75,1983.833,1983.917,1984,1984.083,1984.167,
1984.25,1984.333,1984.417,1984.5,1984.583,1984.667,1984.75,1984.833,1984.917,
1985,1985.083,1985.167,1985.25,1985.333,1985.417,1985.5,1985.583,1985.667,
1985.75,1985.833,1985.917,1986,1986.083,1986.167,1986.25,1986.333,1986.417,
1986.5,1986.583,1986.667,1986.75,1986.833,1986.917,1987,1987.083,1987.167,
1987.25,1987.333,1987.417,1987.5,1987.583,1987.667,1987.75,1987.833,1987.917,
1988,1988.083,1988.167,1988.25,1988.333,1988.417,1988.5,1988.583,1988.667,
1988.75,1988.833,1988.917,1989,1989.083,1989.167,1989.25,1989.333,1989.417,
1989.5,1989.583,1989.667,1989.75,1989.833,1989.917,1990,1990.083,1990.167,
1990.25,1990.333,1990.417,1990.5,1990.583,1990.667,1990.75,1990.833,1990.917,
1991,1991.083,1991.167,1991.25,1991.333,1991.417,1991.5,1991.583,1991.667,
1991.75,1991.833,1991.917,1992,1992.083,1992.167,1992.25,1992.333,1992.417,
1992.5,1992.583,1992.667,1992.75,1992.833,1992.917,1993,1993.083,1993.167,
1993.25,1993.333,1993.417,1993.5,1993.583,1993.667,1993.75,1993.833,1993.917,
1994,1994.083,1994.167,1994.25,1994.333,1994.417,1994.5,1994.583,1994.667,
1994.75,1994.833,1994.917,1995,1995.083,1995.167,1995.25,1995.333,1995.417,
1995.5,1995.583,1995.667,1995.75,1995.833,1995.917,1996,1996.083,1996.167,
1996.25,1996.333,1996.417,1996.5,1996.583,1996.667,1996.75,1996.833,1996.917,
1997,1997.083,1997.167,1997.25,1997.333,1997.417,1997.5,1997.583,1997.667,
1997.75,1997.833,1997.917,1998,1998.083,1998.167,1998.25,1998.333,1998.417,
1998.5,1998.583,1998.667,1998.75,1998.833,1998.917,1999,1999.083,1999.167,
1999.25,1999.333,1999.417,1999.5,1999.583,1999.667,1999.75,1999.833,1999.917,
2000,2000.083,2000.167,2000.25,2000.333,2000.417,2000.5,2000.583,2000.667,
2000.75,2000.833,2000.917,2001,2001.083,2001.167,2001.25,2001.333,2001.417,
2001.5,2001.583,2001.667,2001.75,2001.833,2001.917,2002,2002.083,2002.167,
2002.25,2002.333,2002.417,2002.5,2002.583,2002.667,2002.75,2002.833,2002.917,
2003,2003.083,2003.167,2003.25,2003.333,2003.417,2003.5,2003.583,2003.667,
2003.75,2003.833,2003.917,2004,2004.083,2004.167,2004.25,2004.333,2004.417,
2004.5,2004.583,2004.667,2004.75,2004.833,2004.917,2005,2005.083,2005.167,
2005.25,2005.333,2005.417,2005.5,2005.583,2005.667,2005.75,2005.833,2005.917,
2006,2006.083,2006.167,2006.25,2006.333,2006.417,2006.5,2006.583,2006.667,
2006.75,2006.833,2006.917,2007,2007.083,2007.167,2007.25,2007.333,2007.417,
2007.5,2007.583,2007.667,2007.75,2007.833,2007.917,2008,2008.083,2008.167,
2008.25,2008.333,2008.417,2008.5,2008.583,2008.667,2008.75,2008.833,2008.917,
2009,2009.083,2009.167,2009.25,2009.333,2009.417,2009.5,2009.583,2009.667,
2009.75,2009.833,2009.917,2010,2010.083,2010.167,2010.25,2010.333,2010.417,
2010.5,2010.583,2010.667,2010.75,2010.833,2010.917,2011,2011.083,2011.167,
2011.25,2011.333,2011.417,2011.5,2011.583,2011.667,2011.75,2011.833,2011.917,
2012,2012.083,2012.167,2012.25,2012.333,2012.417,2012.5,2012.583,2012.667,
2012.75,2012.833,2012.917,2013,2013.083,2013.167,2013.25,2013.333,2013.417,
2013.5,2013.583,2013.667,2013.75,2013.833,2013.917,2014,2014.083,2014.167,
2014.25,2014.333,2014.417,2014.5,2014.583,2014.667,2014.75,2014.833,2014.917,
2015,2015.083,2015.167,2015.25,2015.333,2015.417,2015.5,2015.583,2015.667,
2015.75,2015.833,2015.917
)

class(dates) <- "yearmon"
```

```{r}
us <- c(
7.9,7.7,7.6,7.7,7.4,7.6,NA,NA,7.6,7.7,7.8,NA,7.5,7.6,7.4,7.2,7,7.2,6.9,7,6.8,NA,
NA,6.4,6.4,6.3,6.3,6.1,6,5.9,6.2,5.9,6,5.8,5.9,6,5.9,5.9,NA,NA,NA,NA,NA,6,5.9,6,
5.9,6,6.3,NA,NA,6.9,7.5,7.6,7.8,7.7,7.5,NA,NA,7.2,7.5,7.4,7.4,7.2,NA,NA,7.2,7.4,
7.6,7.9,8.3,8.5,8.6,8.9,9,9.3,9.4,NA,NA,NA,NA,NA,10.8,10.8,10.4,10.4,10.3,10.2,
10.1,10.1,9.4,9.5,9.2,NA,NA,NA,8,NA,7.8,NA,NA,7.2,7.5,7.5,7.3,7.4,7.2,7.3,7.3,
7.2,7.2,7.3,7.2,7.4,7.4,7.1,7.1,7.1,7,7,6.7,7.2,7.2,7.1,7.2,7.2,7,6.9,7,7,6.9,
6.6,6.6,6.6,6.6,6.3,6.3,6.2,6.1,6,5.9,6,5.8,5.7,NA,NA,NA,5.4,5.6,5.4,5.4,5.6,
5.4,NA,NA,NA,5.4,5.2,5,5.2,NA,NA,NA,NA,5.3,5.3,5.4,NA,5.4,5.3,5.2,5.4,5.4,5.2,
5.5,5.7,5.9,5.9,6.2,6.3,6.4,6.6,6.8,6.7,6.9,6.9,6.8,6.9,6.9,7,7,7.3,7.3,7.4,7.4,
7.4,7.6,7.8,7.7,7.6,7.6,7.3,7.4,7.4,7.3,7.1,7,7.1,7.1,7,6.9,6.8,6.7,6.8,6.6,6.5,
6.6,NA,6.5,6.4,6.1,NA,NA,6,5.9,5.8,5.6,5.5,5.6,5.4,5.4,5.8,5.6,5.6,5.7,5.7,5.6,
5.5,5.6,NA,NA,NA,NA,NA,5.6,5.3,5.5,5.1,5.2,5.2,5.4,5.4,5.3,5.2,5.2,5.1,4.9,5,
4.9,4.8,4.9,4.7,4.6,4.7,4.6,4.6,4.7,4.3,4.4,4.5,4.5,4.5,4.6,4.5,NA,NA,NA,4.4,
4.2,4.3,4.2,4.3,4.3,4.2,4.2,4.1,4.1,4,4,4.1,4,3.8,4,4,4,4.1,3.9,NA,NA,NA,4.2,
4.2,4.3,4.4,4.3,4.5,4.6,4.9,5,5.3,5.5,5.7,NA,NA,NA,5.9,5.8,5.8,5.8,5.7,5.7,5.7,
5.9,6,5.8,5.9,5.9,6,6.1,6.3,6.2,6.1,6.1,6,5.8,5.7,5.7,5.6,5.8,5.6,5.6,5.6,5.5,
5.4,5.4,5.5,5.4,5.4,5.3,5.4,5.2,5.2,5.1,5,5,4.9,5,5,5,4.9,4.7,4.8,4.7,4.7,4.6,
4.6,4.7,4.7,4.5,4.4,4.5,4.4,4.6,4.5,4.4,4.5,4.4,4.6,4.7,4.6,4.7,4.7,4.7,5,5,4.9,
5.1,5,5.4,5.6,5.8,NA,NA,NA,6.8,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,10,9.9,9.9,9.8,9.8,
9.9,9.9,9.6,9.4,9.4,9.5,9.5,9.4,9.8,9.3,9.1,9,9,9.1,9,9.1,9,9,9,8.8,NA,NA,NA,NA,
NA,8.2,8.2,8.2,8.2,8.1,7.8,7.8,7.7,7.9,8,7.7,7.5,7.6,7.5,7.5,7.3,7.3,7.3,7.2,
6.9,6.7,6.6,6.7,6.7,6.2,6.2,6.1,6.2,6.2,6,5.7,5.8,5.6,5.7,5.5,5.5,5.4,5.5,5.3,
5.3,5.1,5.1,5,5,5
)

ma <- c(
11.6,NA,10.9,NA,9.4,9.8,9.7,9,9,8.3,8.3,8.2,9.5,9.2,8.8,NA,7.6,8.2,7.8,NA,7.5,
6.6,NA,6.2,7.5,7.2,6.9,6,5.9,6.4,6.5,5.9,6,5.2,NA,5.7,6.7,6.4,6.2,5.4,5.2,5.7,
5.4,NA,5.4,4.7,4.8,4.9,6.1,5.8,5.8,5.3,5.6,6.1,6.1,5.7,5.6,5.2,NA,5.1,6.7,6.4,
6.3,5.7,5.9,6.5,NA,6.5,6.8,6.4,6.7,7,8.4,8.2,8,7.5,7.5,8,8,7.6,7.6,7.1,7.3,7.4,
8.3,8,7.7,6.9,6.8,7.1,6.6,6.4,6.4,5.7,5.6,5.6,6.5,6,5.7,5,4.5,4.7,4.7,4.4,4.4,
3.7,3.7,3.8,4.9,4.5,4.4,NA,3.8,4.2,4.2,3.8,3.8,3.4,3.4,3.5,NA,4.4,4.3,3.8,3.9,
4.2,4.1,3.8,3.9,3.3,3.3,NA,4.3,4.2,4,3.3,3.2,3.4,3.3,2.8,2.9,2.4,2.5,2.6,3.9,
3.7,3.6,3,3,3.4,3.4,3.1,3.2,2.8,3,3.1,4.3,4.1,4,3.7,3.7,4.2,4.3,4.1,4.4,4.1,4.3,
4.5,5.8,NA,5.9,5.6,5.7,6.1,6.5,6.4,6.8,6.5,7,7.3,8.7,8.8,8.9,8.3,8.6,8.9,8.9,
8.7,8.8,8.3,NA,NA,9.4,9.2,9,8.3,8.4,8.8,8.7,8.3,8.4,7.7,NA,7.6,8.6,8.2,7.8,7.1,
6.9,7.1,6.9,6.5,6.6,6.1,6,6,7.3,6.9,6.7,6.1,5.8,6.2,6.1,5.8,5.8,5.4,5.3,5.3,6.4,
5.9,5.7,5.3,NA,5.5,5.5,5.1,5.2,4.6,4.6,4.6,5.7,5.2,5,4.4,4.4,4.5,4.6,4,4.2,3.7,
3.8,3.8,4.9,4.6,4.4,3.9,3.8,4.2,4.1,3.7,3.8,3.2,3.2,3.3,4.2,3.9,3.8,3,3.1,3.5,
3.4,3,3.2,2.8,2.8,2.9,3.9,3.6,3.4,3.1,3,3.4,3.5,3,3.2,2.7,2.7,2.7,3.6,3.3,3.1,
2.4,2.5,2.8,2.8,2.5,2.5,2.1,2.3,2.4,3.7,3.5,3.6,3.2,3.3,3.8,3.9,3.8,4,3.7,4,4.2,
5.5,5.3,5.3,5,5,5.5,5.5,5.3,5.4,5,5.2,5.2,6.3,6,5.9,5.5,5.6,6.1,5.9,5.7,5.8,5.2,
5.3,5.2,6.2,5.8,5.7,5.1,5.1,5.5,5.3,4.8,4.9,4.4,4.5,4.5,5.6,5.4,5.1,4.7,4.6,5,
4.9,4.5,4.9,4.4,4.7,4.6,5.5,5.4,5.2,4.9,4.7,5.1,5,4.7,4.9,4.3,4.5,4.6,5.6,5.2,
4.8,NA,NA,4.8,4.7,4.3,4.5,4,4.1,4.4,5.4,5.2,5,4.6,5,5.6,5.7,5.6,5.9,5.7,6.1,6.6,
7.9,7.9,7.8,7.3,7.7,8.3,8.4,8.2,8.6,8.2,8.3,8.5,9.6,9.2,8.9,8.3,8.2,8.4,8.3,7.9,
8,7.5,7.7,7.6,8.5,8.1,7.7,7.2,7.1,7.6,7.4,6.9,7.1,6.5,6.4,6.6,7.4,7.2,6.8,6.3,
6.3,6.9,6.9,6.6,6.6,6.2,6.2,6.5,7.6,7.2,7,6.6,6.6,7.3,7,6.6,6.6,6.2,6,5.9,6.8,
6.5,6.2,5.5,5.5,6,6,NA,5.7,5,5,4.9,5.8,5.5,5.2,4.7,4.9,5.2,5.2,4.7,4.9,4.5,4.5,
4.6
)
```

```{r}
df <- data.frame(us = us, ma = ma)
unemployment <- as.xts(df, order.by = dates)

labels <- c("US Unemployment (%)", "MA Unemployment (%)")
lty = 1:2
```


```{r}
# View a summary of your unemployment data
summary(unemployment)

# Use na.approx to remove missing values in unemployment data
unemployment <- na.approx(unemployment)

# Plot new unemployment data
plot.zoo(unemployment, plot.type = "single", lty = lty)
legend("topright", lty = lty, legend = labels, bg = "white")

```

```{r}
# Create a one month lag of US unemployment
us_monthlag <- lag.xts(unemployment$us, k = 1)

# Create a one year lag of US unemployment
us_yearlag <- lag.xts(unemployment$us, k = 12)

# Merge your original data with your new lags 
unemployment_lags <- merge(unemployment, us_monthlag, us_yearlag)

# View the first 15 rows of unemployment_lags
head(unemployment_lags, n = 15)

```

```{r}
# Generate monthly difference in unemployment
unemployment$us_monthlydiff <- diff(unemployment$us, lag = 1, differences = 1)

# Generate yearly difference in unemployment
unemployment$us_yearlydiff <- diff(unemployment$us, lag = 12, differences = 1)

# Plot US unemployment and annual difference
par(mfrow = c(2,1))
plot.xts(unemployment$us)
plot.xts(unemployment$us_yearlydiff, type = "h")

```

```{r}
# data prep
gdp <- gdp_approx
colnames(gdp) <- c("gdp")

# Add a quarterly difference in gdp
gdp$quarterly_diff <- diff.xts(gdp$gdp, lag = 1, differences = 1)

# Split gdp$quarterly_diff into years
gdpchange_years <- split(gdp$quarterly_diff, f = "years")

# Use lapply to calculate the cumsum each year
gdpchange_ytd <- lapply(gdpchange_years, FUN = cumsum)

# Use do.call to rbind the results
gdpchange_xts <- do.call(rbind, gdpchange_ytd)

# Plot cumulative year-to-date change in GDP
plot.xts(gdpchange_xts, type = "h")

```

```{r}
# data prep
lty = c(2,1)
lwd = c(1,2)

# Use rollapply to calculate the rolling yearly average US unemployment
unemployment$year_avg <- rollapply(unemployment$us, width = 12, FUN = mean)

# Plot all columns of US unemployment data
plot.zoo(unemployment[, c("us", "year_avg")], plot.type = "single", lty = lty, lwd = lwd)

```

```{r}
# Add a one-year lag of MA unemployment
unemployment$ma_yearlag <-  lag.xts(unemployment$ma, k = 12)

# Add a six-month difference of MA unemployment
unemployment$ma_sixmonthdiff <- diff.xts(unemployment$ma, lag = 6, difference = 1)

# Add a six-month rolling average of MA unemployment
unemployment$ma_sixmonthavg <- rollapply(unemployment$ma, width = 6, FUN = mean)
  
# Add a yearly rolling maximum of MA unemployment
unemployment$ma_yearmax <- rollapply(unemployment$ma, width = 12, FUN = max)

# View the last year of unemployment data
tail(unemployment, n = 12)
unemployment["2015"]

```




































