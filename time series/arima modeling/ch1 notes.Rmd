---
title: "ARIMA modeling"
output: html_notebook
---

# Chapter 1

```{r}
library(xts)
#install.packages("astsa")
library(astsa)
```

```{r}
# View a detailed description of AirPassengers
help(AirPassengers)

# Plot AirPassengers
plot(AirPassengers)

# Plot the DJIA daily closings
plot(djia$Close)

# Plot the Southern Oscillation Index
plot(soi)
```

```{r}
# data prep
x <- c(
  2.985857, -6.361563, -0.1456666, 4.928547, 3.262561, 3.655606, 4.519001, 9.937559, 11.75398, 2.309079, 4.459623, -3.359043, 3.124391, 4.323518, 3.388377, -1.369031, -5.129336, 0.5116418, 6.112454, 15.32933, 9.687332, 9.862049, 15.96736, 16.34166, 20.59443, 20.22463, 22.41646, 23.8751, 19.25964, 12.62685, 3.422333, 7.837126, 13.6312, 17.47459, 15.23104, 17.79473, 12.09202, 10.45664, 7.812666, 14.78253, 11.18854, 23.88491, 30.7432, 33.85002, 33.4494, 27.21791, 23.1117, 27.16055, 20.39111, 21.10117, 19.14381, 20.09413, 16.19058, 13.71023, 14.61441, 14.93351, 29.11327, 31.37819, 32.78278, 30.41107, 28.24424, 29.05854, 35.97817, 34.94913, 38.22296, 31.31794, 29.17042, 22.33487, 16.54229, 23.96077, 20.80173, 19.30395, 19.13875, 13.0404, 9.880106, 3.250486, -4.199183, -7.962619, -4.508321, -6.285373, -2.453039, -4.711892, 1.630879, 1.195855, 5.283081, 5.150034, 3.719978, 0.6657675, 2.73845, 8.746976, 8.222104, 18.66304, 11.38429, 10.31788, 21.09079, 25.04151, 24.79819, 34.68633, 26.32639, 23.35433, 23.77118, 22.74452, 29.20337, 30.20594, 36.22878, 37.65178, 36.37345, 39.84203, 27.82309, 26.59692, 26.91488, 24.3732, 28.51265, 26.73985, 30.40227, 39.59151, 44.80342, 44.099, 40.22484, 42.98464, 40.83077, 42.40456, 41.42608, 40.45902, 27.98149, 40.46368, 44.36812, 47.90821, 49.07354, 48.43309, 49.89235, 61.60282, 63.68136, 72.34631, 71.15182, 74.72565, 79.19345, 83.19764, 74.49183, 72.10007, 66.12035, 63.75272, 63.14797, 67.41726, 74.25746, 68.87258, 68.19525, 70.05912, 71.87437, 73.24819, 79.21067, 78.52041, 87.26193, 87.76285, 91.36758, 93.32748, 97.50425, 103.3569, 94.60927, 91.35732, 85.87097, 86.28473, 86.22514, 84.26678, 86.94661, 92.02291, 82.0012, 88.67859, 85.36627, 88.96406, 96.04592, 96.26585, 90.95959, 88.49451, 95.49324, 92.91899, 88.75859, 91.07832, 92.47925, 93.56528, 94.34554, 87.98728, 88.73113, 102.6294, 96.46595, 92.21945, 91.92474, 84.98549, 90.25845, 82.24101, 89.71122, 86.68577, 85.92179, 95.07927, 95.04793, 101.2393, 99.30966, 94.16825, 96.03126, 91.77688, 91.12896, 95.56809, 101.2689, 100.3594, 103.8543, 97.58359, 98.92715, 103.799, 105.883, 102.1103, 105.8276, 107.9296, 101.8401, 107.2261, 106.4817, 111.6719, 116.1099, 115.1661, 115.6657, 115.8189, 120.278, 118.6835, 109.1592, 109.7436, 117.1348, 114.0379, 116.9896, 113.5988, 111.9652, 114.1912, 108.2102, 105.3345, 108.2169, 112.0761, 102.6672, 112.187, 113.2779, 112.4105, 103.1019, 98.73012, 103.9845, 97.90902, 104.8979, 108.135, 103.5588, 102.4043, 102.0028, 100.3617, 97.98295, 89.85094
)
x <- ts(x)

y <- c(
  1.075188, -1.223276, -0.8065997, 2.202825, -0.1880513, 0.9090331, -1.197033, -0.6967935, 1.138503, -3.750186, 3.214067, -3.412409, -0.5706895, 2.462822, 0.8796744, 2.647047, 3.348698, 2.127448, 1.495064, -1.034275, -0.2177603, 2.532921, -0.3333298, -1.131375, 3.423168, -2.657336, 2.344447, 5.106971, 2.761074, 0.2876806, -1.433302, 2.923553, 0.1324486, 4.203259, 0.1539221, -0.4517047, 5.293358, 0.9238603, 6.371447, 6.876115, 2.661717, 4.127917, 6.169708, 2.661915, 2.358058, 8.562576, 3.638691, 3.044878, 1.58672, 5.217553, 5.688859, 2.421499, 3.67225, 3.632633, 4.452598, 5.353482, 6.808038, 5.512103, 6.705777, 3.726197, 9.61742, 7.836747, 5.177487, 5.886449, 4.273393, 12.01679, 5.08893, 6.280159, 4.265168, 4.162007, 5.920096, 8.984218, 13.74501, 9.416709, 8.917358, 7.543039, 6.232575, 9.270245, 8.923392, 9.299579, 6.579452, 9.418907, 8.909177, 10.93158, 9.973343, 7.81034, 10.23683, 10.28997, 8.681128, 10.31467, 6.729532, 12.78758, 5.987985, 9.335637, 10.54082, 10.14219, 10.26082, 9.047313, 11.58688, 13.58861, 9.46641, 7.415744, 11.07672, 14.29013, 11.25113, 11.68346, 11.51535, 9.054254, 11.51849, 11.48782, 9.008088, 11.88761, 10.83536, 8.402471, 11.37577, 10.33811, 10.49191, 14.83341, 11.638, 12.15534, 14.19388, 13.25407, 9.684636, 12.80653, 14.34609, 12.98152, 11.54542, 12.76706, 12.68506, 11.44668, 12.97783, 12.64784, 15.69489, 12.07625, 12.14232, 13.44011, 15.3413, 14.43672, 13.86299, 13.13093, 10.98929, 12.36879, 13.51256, 14.67798, 15.27807, 15.55378, 14.06931, 14.66651, 15.66284, 14.07352, 15.61873, 14.47815, 15.25135, 13.011, 11.42983, 20.19182, 19.05927, 16.7098, 15.63425, 11.2168, 18.61976, 15.23064, 17.64911, 16.8749, 17.84771, 15.4435, 19.32536, 19.32058, 15.17685, 17.64336, 13.91956, 20.69598, 21.28879, 16.42488, 20.29155, 17.4472, 15.40368, 18.64929, 17.77106, 18.59013, 18.58469, 18.49956, 20.18745, 21.13727, 18.36477, 19.77366, 20.3995, 19.54943, 19.22751, 18.86686, 20.78977, 22.0548, 20.58071, 19.31215, 16.18781, 16.57065, 18.10802, 22.09236, 22.49795, 19.81087, 21.90492, 24.06032, 20.80675, 23.12549, 20.63542, 23.86141, 17.86596, 20.32375, 17.46331, 19.12526, 19.32204, 22.68451, 21.81919, 18.62063, 24.95213, 21.93208, 18.46967, 19.51315, 22.29255, 21.43819, 25.93007, 17.85385, 20.70457, 22.37471, 21.0983, 25.71793, 19.83151, 27.54211, 20.78846, 17.8304, 23.04412, 21.08232, 21.66477, 24.24636, 25.50726, 23.76941, 25.6801, 22.93655, 26.67487, 26.63384, 24.30087, 25.50756, 26.28253, 23.92348, 25.93787, 26.95821, 24.28876, 24.69386, 28.61571, 26.60186
)
y <- ts(y)

# Plot detrended y (trend stationary)
plot(x)
plot(diff(x))

# Plot detrended x (random walk)
plot(y)
plot(diff(y))
```

```{r}
# Plot globtemp and detrended globtemp
par(mfrow = c(2,1))
plot(globtemp) 
plot(diff(log(globtemp)))

# Plot cmort and detrended cmort
par(mfrow = c(2,1))
plot(cmort)
plot(diff(log(cmort)))
```

```{r}
# Generate and plot white noise
WN <- arima.sim(model = list(order = c(0,0,0)), n = 200 )
plot(WN)

# Generate and plot an MA(1) with parameter .9 
MA <- arima.sim(model = list(order = c(0,0,1), ma = 0.9), n = 200)
plot(MA)

# Generate and plot an AR(2) with parameters 1.5 and -.75
AR <- arima.sim(model = list(order = c(2,0,0), ar = c(1.5, -0.75)), n = 200)
plot(AR)
```









