---
title: "R Notebook"
output: html_notebook
---

# Chapter 3 - 

```{r}
# prep data
stocka <- c(0.1, 0.4, 0.5, 0.5, 0.2, 0.3, 0.7, 0.8, 0.7, 0.2, 0.1, 0.2)
stockb <- c(0.9, 0.6, 0.5, 0.5, 0.8, 0.7, 0.3, 0.2, 0.3, 0.8, 0.9, 0.8)

m <- matrix(c(stocka, stockb), ncol = 2, nrow = length(stocka))
colnames(m) <- c("stocka", "stockb")
tseq <- seq(from = as.Date("2016-01-01"), to = as.Date("2016-12-01"), by = "month")
portfolio <- as.xts(m, order.by = tseq)
```

```{r}
# Plot stacked barplot
barplot(portfolio)

# Plot grouped barplot
barplot(portfolio, beside = TRUE)
```

```{r}
# prep data
sp500 <- c(
-0.01822471, -0.009463606, 0.01238417, 0.01758942, -0.008045853, -0.007864407, 
-0.00281666, -0.006055512, -0.00920281, 0.01302901, 0.002130314, 0.005035328, 
0.01476152, -0.005497881, 0.002339048, -0.01327829, -0.01290728, 0.0092011, 
-0.01265465, 0.012308, 0.0143576, -0.003815114, 0.01004444, -0.002769171, 
-0.004485833, 0.01059699, 0.0005800516, 0.009570856, 0.004107963, 0.001571852, 
9.520072e-05, -0.0007141416, 0.005982685, -0.0001420193, 0.002836705, 
-0.0008501485, -0.001182004, -0.003412007, 0.006293649, -0.004112459, 
-0.004224517, 0.001093493, -0.0141643, 0.004136012, -0.01635496, -0.002344417, 
0.01263382, -0.006151207, 0.01327208, -0.002976886, 0.01194986, -0.004571906, 
0.008788076, -0.001950498, -0.005634854, -0.01476226, -0.002384209, 
0.002287058, 0.01212602, -0.008777945, -0.003542553, 0.00359104, 0.006710623, 
-0.002649918, 0.003371372, 0.004413738, 0.005442319, -0.004533194, 0.001911269, 
0.004476987, -0.0002851585, -0.01157021, 0.009095367, -0.001192037, 
0.004902082, 0.002513096, 0.002317782, -0.004166425, 0.00317377, -0.00412311, 
-0.01007096, 0.01078303, 0.002843362, -0.01151797, -0.004125303, 0.003981687, 
0.01308017, -0.004784106, -0.002995813, 0.0001905125, 0.0103736, 0.001083224, 
0.003101959, -0.0003285702, -0.0007043456, 0.00290818, -0.002391587, 
-0.01080994, 0.009447404, -0.001128942, -0.00623235, 0.002034528, 
-0.0009930999, 0.002645991, -0.008482427, -0.001714698, -0.006168619, 
-0.0001439052, 0.01192194, 0.003218369, -0.00768437, -0.004294689, 0.005436868, 
0.001615795, 0.01034567, -0.004449094, 0.005110027, 0.0007076358, -0.007289248, 
-0.003045009, -0.0001905901, -0.0211934, 0.002091119, 0.007983564, 
-0.0009160916, -0.002850019, 0.006269023, -0.01691959, 0.001807368, 0.0125129, 
0.01097678, 0.004328647, -0.0003322728, 0.007992297, 0.0008474608, 
0.0005175646, -0.003959074, -0.001796205, -0.005645858, -0.01042619, 
-0.005834325, 0.01220821, 0.006855551, 0.0002372075, -0.001519067, 
-0.003378655, -0.001956193, 0.003290039, -0.008221457, -0.001921735, 
0.01252052, -0.009064126, 0.001197344, -0.00124524, 0.003635645, 0.005571298, 
-0.002900829, -0.007936874, -0.02110246, -0.03056485, -0.04301906, -0.01183757, 
0.03767507, 0.02443419, 5.015283e-05, -0.008111902, -0.0303022, 0.01880317, 
0.0007161848, -0.01525256, 0.0248205, -0.01346203, 0.005427069, 0.004533999, 
-0.003717436, 0.01242195, 0.008629322, -0.002250495, -0.01647645, 0.005154305, 
-0.01306473, -0.001599945, -0.003622319, -0.0002591684, -0.02541759, 
0.0005849058, 0.01848642, 0.002605797, 0.01482731, 0.0176384, -0.003432132, 
0.008157195, 0.008986147, 0.0005961915, 0.000943293, -0.006322067, 
-0.004805571, 0.01523789, 0.004536261, 0.0004917899, -0.00127925, -0.006222825, 
0.01675256, 0.01090207, -0.002460715, -0.001934207, 0.01131039, -0.0005744433, 
-0.004319084, 0.0117615, 0.002895184, -0.003037781, -0.0009988182, 
-0.0005235791, -0.009375322, 0.002304126, -0.003939435, -0.01405816, 
-0.0112918, 0.01509242, -0.0007297396, 0.01574149, -0.0008626925, 0.003637555, 
-0.001147234, 0.001338365, -0.0001433055, 0.001145865, -0.004160173, 
0.009490452, -0.01025745, -0.01410174, 0.01931517, -0.006076956, -0.006742184, 
-0.007810083, 0.002577754, -0.01957139, 0.005039732, 0.01044309, 0.01452599, 
-0.01535547, -0.0179756, 0.008215307, 0.009033315, 0.01230727, -0.001651746, 
-0.002287651, 0.01061539, -0.007112995, -0.01005376, -0.01407809, 0.001689927, 
-0.01269442, -0.02428406, -0.01103726, 0.0009895168, 0.008035935, -0.02525691, 
0.01628353, -0.02169988, 0.001330246, -0.0128979, 0.005586349, 0.0203077, 
-0.01523197, 0.0135509, -0.01094289, 0.005195621, 0.02408496, -0.0003614509, 
-0.01818653, 0.005977053, 0.001567005, -0.01923395, -0.01355244, 5.390046e-05, 
-0.000863166, -0.01309341, 0.02040724, 0.01673743, 0.01620276, -0.004104269, 
-0.0004686225, 0.01437534, -0.01271002, 0.00456522, 0.01203902, -0.002303953, 
-0.007873442, 0.0232349, 0.004482389, 0.003911933, 0.003248267, 0.0007979812, 
-0.01097784, 0.004927413, 0.0008021047, 0.0160083, -0.001283099, -0.001630968, 
0.005770517, 0.006324058, 0.003921936, 0.001417887, -0.0005375997, 
-0.006621361, -0.0004430461, 0.0005906611, 0.009207574, 0.004378124, 
-0.002429898, 0.006788863, -0.00324321, -0.01003808, 0.01086197, -0.01203807, 
0.002693123, -0.002349923, 0.009269686, 0.01005034, 4.804809e-05, -0.001106304, 
0.007002122, 0.003149253, 0.0009524402, -0.005392934, 0, -0.00172422, 
0.001484909, 0.00205613, -0.00911719, -0.005413494, 0.007917004, -0.008741257, 
-0.005593854, -0.0001950988, 0.003652393, 0.0008260152, 0.01235715, 
-0.009398777, 0.0002905006, -0.008752378, 0.009816886, -0.009377388, 
0.0002928402, -0.003470985, 0.006297506, -0.001363516, 0.01287898, 0.006760201, 
0.0002866423, 0.004290056, -0.001904445, 0.002047124, 0.003039078, 
-0.002991548, 0.005075587, 0.00156011, 0.003254349, -0.001366443, -0.009522729, 
-0.007741653, -0.001968854, -0.001394903, 0.002979888, -0.003731097, 
0.006419411, 0.00283455, -0.001632481, 0.01293848, -0.03656967, -0.01807218, 
0.0178753, 0.01688425, 0.0135533, 0.002098246, -0.007219185, 0.005979877, 
-0.0006202646, 0.01478067, 0.00352072, 0.007237118, -0.0001395734, 0.005567928, 
-0.001342714, 0.002683703, -0.00101711, 0.004154333, -0.003784351, 0.004475113, 
-0.002719636, 0.0004614959, -0.001061677, 0.001153962, 0.001613271, 
-0.0008293472, -0.006427914, 0.002918444, 0.001063416, 0.008145602, 
-0.000595966, 0.000595966, -0.002478056, 0.004629929, -0.0008692848, 
0.002879625, -0.005170998, 0.001879259, 0.002241407, -0.001463224, 
-4.573327e-05, 0.002011438, -0.005127956, -0.0006888267, -0.001885119, 
0.004912245, -0.001650017, -0.002848066, 4.597521e-05, 0.004497877, 
0.003017853, -9.133818e-05, -0.002285608, -0.02422591, 0.01424538, -0.01447986, 
-0.0003752581, 0.009943385, -0.003873107, 0.0001874911, 4.683177e-05, 
0.01118271, 0.006281708, -0.005494333, -0.008135228, 0.006188807, 0.004951271, 
-0.009088475, 0.007517835, -0.002406982, -0.005110853, 0.004415487, 
0.0006953654, -0.003435339, 0.005194867, -0.01271001, 0.001311109, -0.0032809, 
0.0005162755, -0.003478215, 0.00624284, 0.00266358, -0.001868434, 0.0004673981, 
0.004243735, -0.003356183, -0.002009733, -0.002670389, -0.002959785, 
4.709476e-05, -0.007271773, -0.006036802, -0.004587637, -0.001102222, 
0.02181728, 0.004493792, 0.01054624, 0.002492466, -0.002307657, 0.0007851928, 
0.007772491, -0.001880106, 0.005127561, -0.002240081, 0.007523092, 0.001951342, 
0.0005438536, 0.003708597, -0.004705929, 0.001948429, -0.002402044, 
-0.003682233, 0.0005007904, 0.005990791, 0.003162402, 0.01299596, 0.002445751, 
0.006022249, -0.001148485, 0.006651835, -0.008288512, 0.004108747, -0.00195774, 
0.002175048, 0.003850134, -0.00278652, -0.001728912, 0.001463134, 0.002477977, 
-0.008298852, -0.0002227856, -0.00366173
)

# cat(citi, sep = ', ', fill = TRUE)
citi <- c(
-0.0320222, -0.03583914, 0.009227448, 0.0149358, -0.02258664, -0.007908248, 
-0.007171365, -0.01958276, -0.03781091, 0.008013573, -0.007378597, 0.0101054, 
0.03761615, -0.01935085, 0.005537923, -0.01193427, -0.0251533, 0.0109798, 
-0.01416959, 0.01626739, 0.02401773, -0.009868505, 0.002888386, 0.01228512, 
0.001423488, 0.003651137, 0.005854477, 0.02406399, 0.006073113, 0.009524766, 
-0.005237142, -0.00585138, 0.01282817, -0.00892343, 0.0112383, 0.003654173, 
0.006124417, 0.0001907408, 0.0202066, 0.004476729, -0.001117343, -0.002051606, 
-0.009379165, -0.002075293, -0.03302279, 0.02124455, 0.03289462, -0.01003542, 
0.002797683, 0.002789953, -0.002231286, -0.02526054, 0.01138962, -0.009482332, 
-0.01034297, -0.01084017, -0.003704822, -0.003718559, 0.01247093, -0.002326456, 
0.001939076, 0.004638627, -0.004638627, -0.001939076, 0.00715598, 0.004614546, 
0.005738336, 0.004377196, 0.001328399, 0.00906178, 0.01510803, -0.01774256, 
0.002446605, -0.01362626, 0.01174475, 0.002257386, -0.006030904, -0.001892208, 
0.004158042, 0.01386045, -0.00821817, 0.00821817, 0.007597558, -0.01525328, 
-0.009984048, 0.01018111, 0.01323039, -0.0009259908, -0.004270727, 0.008523292, 
0.00735292, -0.006615175, 0.007896399, 0.01200022, -0.007984122, -0.0009113072, 
0.002367744, -0.01336893, 0.01154807, -0.00584904, -0.008653238, 0.006818398, 
0.004946427, 0.01649336, -0.005407354, 0.016313, -0.01054617, 0.00626958, 
0.0180504, 0.00332661, -0.001749454, -0.008087233, 0.007386558, -0.009330196, 
0.003883452, -0.009381412, 0.01272329, 0.007696357, -0.01280157, -0.00832972, 
0.002665987, -0.02625576, 0.006538355, 0.007933661, -0.005583098, -0.005251219, 
-0.01058599, -0.03168953, 0.017088, 0.01570187, 0.01780245, 0.006639754, 
0.009789163, 0.03703163, 0.002727103, 0.001700659, 0.004239098, 0.02076434, 
-0.007819718, -0.01973579, -0.01268664, 0.00704895, 0.009378511, 0.0001699202, 
-0.007158749, -0.0003421728, 0.0005132673, 0.004607123, -0.01095531, 
-0.003275565, 0.01423088, -0.01890419, -0.0127457, 0.00735301, 0.004524859, 
0.003120686, -0.003815492, -0.009602867, -0.02973597, -0.03176624, -0.06274906, 
-0.009179849, 0.04699373, 0.02194564, -0.002998503, 0.003746745, -0.0486593, 
0.01577598, 0.0007726679, -0.02344317, 0.02073631, -0.0150203, 0.003727302, 
0.0005872367, -0.002351078, 0.01981032, 0.01128227, -0.01803575, -0.02668396, 
0.00831684, -0.006528819, -0.005174181, -0.01995024, 0.02849308, -0.03053061, 
-0.0006120369, 0.01237215, 0.005628135, -0.0002004408, 0.02533784, 
-0.001956525, 0.005079088, 0.006409695, -0.005241223, -0.001948219, 
-0.001365987, -0.009614476, 0.0434054, -0.00530007, 0.003221263, -0.0003784487, 
-0.01968526, 0.01342039, 0.02129145, -0.009929805, -0.009459019, 0.03950577, 
-0.01883019, -0.00917355, 0.01233669, 0.006111661, -0.006111661, 0.005927025, 
0.03126954, -0.002867892, 0.001614201, -0.01626048, -0.02657968, -0.005439407, 
0.00973245, -0.003731977, 0.02747471, 0.00145405, -0.005646153, -0.008621548, 
-0.001843975, -0.001847381, 0.002400918, -0.002216043, 0.01449967, -0.01357574, 
-0.01170476, 0.0290997, -0.01260402, -0.01874074, -0.01092285, -0.003034339, 
-0.02968608, -0.0001957147, 0.0274096, 0.02593645, -0.01986204, -0.03133367, 
0.01126228, 0.004238877, 0.01185036, 0.001518849, -0.006280316, 0.01138961, 
-0.01291812, -0.01057193, -0.01205299, -0.005294655, -0.01465667, -0.052428, 
-0.03052858, 0.01548745, 0.0006401997, -0.03671538, 0.004195712, -0.06627352, 
-0.01255798, -0.03518493, -0.008432592, 0.02241196, -0.03746877, 0.02373629, 
0.001480431, -0.002966686, 0.0528025, -0.002351349, -0.04970871, -0.001485433, 
0.01059775, -0.02306363, -0.05279969, -0.007966145, -0.002669456, -0.06716159, 
0.0706306, 0.03533007, 0.02262711, -0.02185604, 0.001797035, 0.01350165, 
-0.03344792, -0.003407188, 0.01381848, 0.02253041, -0.01659264, 0.06042781, 
0.02275822, 0.01434476, 0, -0.005149851, -0.03729817, 0.00243316, 0.005331983, 
0.03841163, -0.007471526, -0.001876571, -0.008488616, 0.01457474, 0.01597448, 
0.001377041, -0.005058579, -0.02355801, -0.01020055, -0.0004769748, 
-0.004782352, 0.003827743, -0.003108938, 0.01709852, -0.009700773, -0.01316288, 
0.00839641, -0.03872396, 0.004954224, 0.0159336, 0.01879125, 0.05456952, 
0.01636255, -0.001334832, 0.004220862, 0.01146146, 0.02403495, -0.002999851, 
0.00790862, -0.005979152, 0.008742991, 0.004871406, -0.01170107, -0.009676462, 
0.008605943, -0.02406623, -0.02017136, -0.009674947, 0.004061371, -0.01177818, 
0.02141412, -0.008285766, -0.01062519, -0.02043465, 0.0009274586, 0.01266567, 
0.04846316, -0.01781632, -0.003557142, 0.004666149, 0.01648932, 0.02327688, 
-0.01784031, 0.01014144, -0.0002147577, 0.007913629, 0.0006389517, -0.03421731, 
0.007681419, -0.004382158, 0.000439092, -0.01214551, -0.02497031, -0.01700022, 
-0.02819736, 0.001190868, 0.002615014, 0.008510701, 0.00750473, 0.002799787, 
-0.005607436, 0.04085945, -0.09823843, -0.04621284, 0.04968073, 0.04070331, 
0.006389812, -0.005203442, -0.03351729, 0.006842694, 0.005585936, 0.01657292, 
0.007357382, 0.02682997, -0.002535358, 0.02551969, -0.002703286, 0.005399284, 
-0.004948301, 0.00270216, -0.007675, 0.003844817, -0.005886326, 0.002494627, 
0.003165978, -0.001133592, -0.006144067, -0.00894201, -0.00995256, 0.02071891, 
-0.00113984, 0.04198922, 0.005235569, -0.001306281, -0.00985231, 0.006141686, 
-0.003285452, 0.01761484, 0.004945705, 0.0002145077, -0.002791807, 
0.0006449153, 0.002790031, -0.001501339, 0.001501339, 0.001285104, 0.008312936, 
0.003178941, 0.01345129, -0.003345876, -0.007991646, 0.003162166, -0.004641297, 
0.004009689, 0.006507861, -0.01305837, 0.01305837, -0.01837243, -0.003629748, 
0.007034084, -0.01433339, 0.003870982, -0.001073748, 0.007705537, 0.004467589, 
0.0008487304, -0.02708683, 0.01040547, 0.01072511, -0.02309371, 0.0307452, 
-0.004243594, 0.01519339, 0.01867277, 0.008596008, 0.004270443, 0.005463966, 
-0.01136603, -0.005937186, -0.00473397, 0.002884217, -0.0002057901, 0.00799273, 
0.009952317, 0.002019023, -0.0002017636, 0.0002017636, 0.0002016417, 
0.008433753, -0.001600927, -0.007437954, -0.008307189, -0.004281864, 
-0.008206808, -0.003935024, -0.0004151119, 0.03368011, 0.001804872, 0.03310649, 
0.03840777, -0.01465638, 0.03441878, 0.0139837, -0.01489853, 0.01489853, 
0.0001803001, 0.001441466, 0.01003229, 0.01046202, 0.001586321, -0.02334177, 
0.0009009772, 0.01554849, 0.01548511, -0.02206814, 0.02224271, 0.01111122, 
0.01949118, 0.01828756, -0.001830436, -0.00819474, 0.004022146, -0.005702792, 
0.01303492, -0.008001363, -0.001507427, 0.018928, -0.0008226858, -0.00428899, 
0.008231842, 0.001638261, -0.01733717, -0.01105354, 0.0008416586
)
```

```{r}
# Draw the scatterplot
plot(x = sp500, y = citi)

# Draw a regression line
abline(reg = lm(citi ~ sp500), col = "red")
```

```{r}
# Prep data
my_data <- read.zoo("https://assets.datacamp.com/production/course_2300/datasets/data_3_2.csv",
         index.column = 1,
         skip = 1,
         sep = ",",
         format = "%Y-%m-%d")
colnames(my_data) <- c("sp500","citigroup","microsoft","apple","dowchemical","yahoo")
```

```{r}
# Create correlation matrix using Pearson method
cor(my_data, method = "pearson")

# Create correlation matrix using Spearman method
cor(my_data, method = "spearman")

```

```{r}
# Create scatterplot matrix
pairs(my_data)

# Create upper panel scatterplot matrix
pairs(my_data, lower.panel = NULL)
```

```{r}
# prep data
#install.packages("corrplot")
library(corrplot)

cor_mat <- cor(my_data[,-1])
cor_mat
```

```{r}
# Create correlation matrix
corrplot(cor_mat)

# Create correlation matrix with numbers
corrplot(cor_mat, method = "number")

# Create correlation matrix with colors
corrplot(cor_mat, method = "color")

# Create upper triangle correlation matrix
corrplot(cor_mat, method = "number", type = "upper")
```

```{r}
# Draw heatmap of cor_mat
corrplot(cor_mat, method = "color")

# Draw upper heatmap
corrplot(cor_mat, method = "color", type = "upper")

# Draw the upper heatmap with hclust
corrplot(cor_mat, method = "color", type = "upper", order = "hclust")
```


