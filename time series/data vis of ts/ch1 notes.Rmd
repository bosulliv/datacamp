---
title: "Data camp ts() viz"
output: html_notebook
---

# Chapter 1
This turned into a nice little time series wrangling exercise. Data wrangling is as important as the maths in statistical analysis. Being fluent in wrangling makes is key - then the brain is free to wrestle with the maths, safe in the knowledge you can always whape the data to fit a stats function.
```{r}
# prep data
yahoo <- c(
50.17, 49.13, 49.21, 48.59, 50.23, 49.72, 48.8, 48.3, 47.51, 46.23, 46.47, 
47.63, 48.18, 48.89, 48.95, 49.44, 47.99, 46.46, 43.73, 43.99, 44.69, 44.7, 
44.05, 43.55, 42.94, 42.57, 43.07, 42.96, 43.93, 44.42, 43.53, 43.65, 44.37, 
44.11, 43.53, 43.38, 44.43, 44.45, 44.28, 44.11, 42.62, 43.99, 44.16, 43.44, 
42.98, 42.68, 42.5, 42.95, 42.87, 43.51, 43.79, 44.67, 44.98, 45.04, 44.72, 
44.42, 44.2, 44.47, 45.1, 44.95, 44.44, 44.13, 44.15, 43.67, 43.61, 45.17, 
45.63, 45.18, 44.77, 45.53, 45.73, 45.78, 44.45, 44.66, 44.49, 43.98, 43.7, 
44.52, 44.36, 44.34, 43.28, 42.57, 42.51, 42.04, 41.3, 41.66, 43.87, 44.09, 
43.6, 43.84, 44.4, 44.95, 44.75, 44.36, 40.98, 42.79, 43.68, 43.49, 42.85, 
43.38, 43.07, 42.94, 43.35, 43.15, 43.21, 42.88, 42.81, 42.01, 41.63, 42.06, 
40.94, 40.53, 40.47, 40.64, 40.96, 40.91, 40.51, 40.73, 40.65, 40.94, 41.07, 
40.06, 38.91, 39.29, 39.33, 39.38, 38.61, 38.23, 37.23, 37.61, 37.92, 38.76, 
38.63, 38.38, 38.91, 39.68, 39.54, 39.73, 39.24, 39.21, 38.85, 37.84, 37.72, 
37.67, 37.42, 36.67, 36.69, 37.12, 37.25, 36.46, 36.67, 37.15, 36.03, 34.49, 
35.93, 36.24, 36.1, 35.69, 35.19, 34.1, 32.93, 31.31, 31.74, 32.52, 33.69, 
33.14, 32.24, 31.6, 31.77, 32.54, 31.58, 30.9, 31.52, 31.15, 31.43, 30.32, 
31.04, 31.4, 30.93, 30.74, 31.17, 30.4, 29.74, 29.34, 29.13, 27.6, 28.26, 
28.91, 28.91, 30.71, 30.85, 30.96, 31.87, 32.37, 32.52, 32.86, 32.34, 32.09, 
33.48, 33.37, 33.5, 32.83, 31.12, 31.67, 33.17, 33.4, 34.3, 35.19, 35.05, 
35.62, 35.27, 34.72, 35.07, 35.12, 34.2, 33.68, 33.99, 33.38, 33.23, 32.19, 
32.95, 32.86, 32.98, 32.63, 33.11, 33.36, 32.96, 33.16, 32.94, 33.81, 33.71, 
35.65, 34.34, 34.91, 34.68, 34.85, 34.4, 34.63, 32.91, 32.59, 33.03, 33.78, 
33.23, 32.95, 32.97, 34.19, 34.45, 34.11, 33.6, 34.04, 33.37, 33.26, 31.4, 
32.2, 32.16, 30.16, 30.63, 30.17, 30.69, 29.44, 30.32, 29.14, 29.74, 28.78, 
29.31, 29.75, 29.78, 29.98, 29.69, 28.75, 29.51, 29.57, 29.06, 27.68, 29.15, 
27.97, 27.05, 26.82, 27.1, 26.76, 27.04, 29.28, 29.37, 29.42, 30.04, 31.17, 
30.67, 30.95, 31.36, 31.37, 31.79, 32.8, 32.91, 32.88, 33.86, 33.96, 32.93, 
33.51, 32.82, 33.81, 33.58, 33.26, 34.01, 34.28, 35.17, 35.47, 35.41, 34.8, 
34.86, 35.23, 36.32, 36.56, 36.81, 36.48, 37.02, 36.41, 36.66, 36.17, 36.07, 
36.48, 36.66, 37.31, 37.17, 36.51, 36.52, 36.33, 37.84, 37.67, 37.48, 37.23, 
37.11, 36.95, 36.59, 36.6, 36.53, 36.01, 36, 36.94, 37.23, 37.18, 37.44, 37.37, 
37.03, 36.48, 37.48, 37.27, 37.24, 37.02, 36.5, 36.66, 37.53, 35.59, 36.76, 
37.82, 37.94, 36.65, 37.15, 36.6, 37.07, 36.73, 36.97, 37.35, 36.83, 36.47, 
37.4, 37.32, 37.39, 36.94, 37.29, 37.4, 37.36, 37.78, 36.24, 35.22, 36.04, 
36.86, 37.56, 37.99, 37.5, 37.51, 37.52, 37.74, 37.96, 37.89, 37.64, 37.96, 
37.72, 37.95, 38.17, 38.9, 38.85, 39.38, 38.32, 38.76, 38.66, 38.52, 38.19, 
38.8, 38.57, 38.39, 38.92, 38.99, 39.24, 39.24, 39.93, 41.27, 42.94, 42.67, 
42.49, 42.7, 42.9, 43.02, 42.52, 42.6, 41.91, 42.03, 42.27, 42.26, 42.58, 
42.75, 42.93, 43.28, 44.71, 44.35, 44.36, 42.92, 43.46, 43.04, 43.46, 43.99, 
43.67, 43.19, 42.79, 44.14, 44.15, 42.8, 42.29, 43.37, 43.69, 42.57, 43.1, 
43.13, 43.18, 43.71, 43.68, 43.22, 43.92, 42.68, 42.36, 41.62, 41.44, 41.79, 
41.68, 42.73, 42.38, 42.17, 42.59, 42.55, 42.08, 41.87, 41.78, 41.55, 41.33, 
40.68, 40.23, 40.28, 41.05, 41.16, 41.21, 40.16, 40.42, 39.3, 40.21, 40.98, 
41.45, 41.19, 41.11, 41.01, 40.96, 40.87, 41.45, 41.6, 41.02, 39.63, 40.07, 
40.2, 39.97, 40.52, 41.41, 41.76, 41.3, 41.47, 40.91, 38.41, 38.61, 38.42, 
39.16, 39.15, 38.5, 38.66, 38.92, 38.73, 38.64, 38.67
)

# had to add fill to the cat expression - otherwise it lost entries!
# There must be a silent max character limit per line..
#
# cat(data[ ,2], sep = ', ', fill = TRUE)
microsoft <- c(
44.30501, 43.89759, 43.25329, 43.80284, 45.09144, 44.71244, 44.15342, 43.92602, 
43.54702, 43.09222, 43.81232, 43.95444, 43.50912, 44.65559, 44.70296, 44.54189, 
40.42027, 39.02745, 39.8044, 38.27893, 39.11272, 39.41592, 39.64332, 40.2213, 
40.1834, 40.13602, 40.36342, 40.15498, 40.8277, 41.56674, 41.58583, 41.53812, 
41.50949, 41.85302, 42.12975, 42.0725, 41.97707, 42.04387, 41.84348, 41.87211, 
41.29956, 41.08963, 41.13734, 40.42166, 40.88923, 40.10676, 40.05905, 39.14297, 
39.4865, 39.65827, 39.79186, 40.55525, 40.35486, 40.91786, 40.89878, 40.93695, 
39.56284, 39.32428, 39.09526, 39.08572, 38.79945, 38.8567, 38.44638, 39.64872, 
39.62964, 39.52467, 39.58192, 39.81094, 39.84911, 39.74415, 40.32623, 40.23081, 
39.71552, 40.94649, 40.68885, 41.02283, 41.35681, 45.67953, 45.8322, 46.9105, 
46.81508, 46.41429, 46.43338, 46.0326, 45.42188, 44.16228, 44.56307, 45.56502, 
45.2024, 45.18332, 45.45051, 46.49063, 46.08985, 45.81312, 45.69787, 45.69787, 
45.5442, 45.04477, 44.74703, 45.72668, 45.57301, 45.00635, 45.36171, 45.06397, 
44.99674, 44.52613, 44.31483, 43.92105, 43.84421, 44.76624, 44.60296, 44.15156, 
43.68094, 44.01709, 44.15156, 44.87189, 44.27641, 44.40127, 44.09393, 43.83461, 
43.84421, 43.46964, 42.61485, 42.40355, 42.69168, 42.64366, 42.63405, 42.54761, 
42.48999, 42.75891, 42.84535, 43.73857, 43.8154, 43.94986, 44.81426, 44.77584, 
45.06397, 45.40973, 43.73857, 44.28602, 44.12274, 43.55608, 43.54648, 44.4589, 
45.02556, 44.85268, 44.95833, 45.65945, 45.69787, 44.77584, 44.8911, 45.45776, 
44.57415, 44.8911, 44.88149, 45.14081, 45.44815, 45.69951, 45.06144, 44.143, 
41.63905, 40.29523, 39.12544, 41.29101, 42.44148, 42.47048, 42.0741, 40.43058, 
41.91942, 42.05477, 41.19434, 42.43181, 41.63905, 41.85175, 42.03543, 41.61005, 
42.51882, 42.82819, 42.77985, 42.03543, 42.6445, 42.44148, 42.41247, 42.45114, 
42.48015, 41.85175, 41.99676, 42.78952, 43.12789, 44.05599, 45.08078, 45.19679, 
45.24513, 45.87353, 45.54483, 45.43848, 45.33214, 45.12912, 45.44815, 45.93154, 
46.03788, 46.1829, 45.63184, 46.43426, 51.11346, 52.44761, 51.90622, 52.18658, 
51.58718, 50.8911, 51.47117, 52.35094, 52.59263, 52.57329, 53.09535, 52.3606, 
51.7322, 51.86755, 51.54851, 51.08446, 51.98356, 51.55531, 52.41181, 52.4994, 
52.74273, 52.74273, 52.80113, 52.25608, 52.48967, 52.89845, 53.74522, 53.73549, 
52.75246, 54.41679, 54.31946, 54.3, 53.51163, 53.79389, 52.6162, 53.66736, 
53.72575, 54.63092, 54.2124, 52.68433, 53.36564, 53.87175, 54.32919, 54.1832, 
54.45572, 55.0397, 54.80611, 53.99828, 53.33644, 53.57976, 52.60647, 50.77668, 
50.93241, 50.9032, 51.37038, 50.26083, 51.69157, 49.62819, 49.20968, 49.43353, 
49.13181, 50.89347, 50.40683, 50.77668, 49.85205, 50.66962, 53.61869, 53.24884, 
51.58451, 50.76694, 50.61122, 48.82036, 48.09039, 47.96386, 48.38238, 48.36291, 
49.15128, 50.08254, 51.38632, 51.16085, 50.79815, 51.61178, 50.17077, 50.34722, 
51.07263, 50.2884, 49.87669, 51.54316, 51.90587, 51.3177, 51.00401, 50.02373, 
50.6315, 51.79803, 51.02361, 52.0235, 52.12153, 52.53325, 53.27826, 53.58215, 
52.43522, 52.79792, 53.00378, 52.90575, 53.14102, 52.48423, 53.63116, 53.96446, 
54.14091, 54.4742, 54.33696, 53.48412, 54.03307, 53.38609, 53.34688, 53.23905, 
53.57234, 54.25854, 54.26834, 54.55263, 55.34665, 55.27803, 54.49381, 54.68006, 
50.75894, 51.08243, 50.42564, 49.9355, 48.91601, 48.8866, 49.61201, 48.79838, 
48.8866, 48.95522, 49.39635, 49.08266, 50.01393, 50.04333, 50.49426, 50.07274, 
50.80795, 49.8603, 50.15644, 49.67274, 49.96888, 49.38647, 50.92641, 51.44959, 
51.22255, 51.64702, 52.31827, 52.1702, 51.80496, 51.12384, 51.45946, 51.42985, 
51.37062, 50.95602, 50.81782, 49.49506, 49.18905, 49.05085, 49.74184, 49.48519, 
49.42596, 50.53155, 50.33413, 51.24229, 49.18905, 47.80705, 48.80406, 49.88992, 
50.51181, 50.50194, 50.51181, 50.71911, 50.71911, 51.62727, 51.91354, 52.52557, 
52.82171, 53.04875, 53.00927, 53.26592, 52.40711, 55.19084, 55.08226, 55.84235, 
56.00029, 56.02991, 55.46724, 55.48698, 55.95094, 55.85222, 55.85222, 56.23721, 
56.6518, 57.21447, 57.31319, 57.45139, 57.2737, 57.5501, 57.19473, 57.37241, 
57.05456, 57.17376, 57.21349, 57.23336, 57.28302, 57.50154, 57.56114, 57.77966, 
57.6406, 57.71013, 57.50154, 57.07443, 57.20356, 57.28302, 57.22342, 57.27309, 
57.04463, 55.83282, 56.66718, 56.15067, 55.88248, 56.80624, 56.86584, 56.54799, 
56.42879, 57.37241, 57.43201, 57.04463, 56.51819, 57.56114, 57.6406, 57.01483, 
57.21349, 57.0347, 56.85591, 57.25322, 57.35255, 57.41215, 57.65054, 56.80624, 
56.72678, 56.53805, 57.0347, 56.83604, 57.27309, 57.14396, 56.86584, 59.25967, 
60.59068, 60.58075, 60.22316, 59.69671, 59.46826, 59.51792, 59.39873, 59.03121, 
58.81269, 58.31604, 60.01457, 60.06423, 59.76624, 58.30611, 58.62396, 57.73, 
58.87, 59.65, 60.64, 60.35, 60.86, 61.12, 60.4, 60.53, 60.61, 61.09, 60.26, 
59.2, 59.25, 60.22, 59.95, 61.37, 61.01, 61.97, 62.17, 62.98, 62.68, 62.58, 
62.3, 63.62, 63.54, 63.54, 63.55, 63.24, 63.28, 62.99, 62.9, 62.14
)

citigroup <- c(
53.45259, 51.76803, 49.94556, 50.40857, 51.16711, 50.02437, 49.63033, 49.27568, 
48.32012, 46.5272, 46.90154, 46.55675, 47.02961, 48.83238, 47.89651, 48.1625, 
47.59113, 46.40898, 46.92135, 46.26118, 47.01989, 48.16287, 47.68991, 47.82786, 
48.41905, 48.48803, 48.66539, 48.95113, 50.14338, 50.44883, 50.93164, 50.6656, 
50.37, 51.02032, 50.56707, 51.13856, 51.32577, 51.64108, 51.65093, 52.70524, 
52.94171, 52.88259, 52.77421, 52.28154, 52.17316, 50.47839, 51.56225, 53.28658, 
52.7545, 52.9023, 53.0501, 52.93186, 51.61152, 52.20272, 51.71005, 51.17797, 
50.62619, 50.43898, 50.25176, 50.88238, 50.76414, 50.86267, 51.09915, 50.86267, 
50.76414, 51.12871, 51.36519, 51.66079, 51.88741, 51.95638, 52.42934, 53.22746, 
52.2914, 52.41949, 51.71005, 52.32095, 52.4392, 52.12389, 52.02536, 52.24213, 
52.97127, 52.53773, 52.97127, 53.37526, 52.56729, 52.04506, 52.57765, 53.27789, 
53.22858, 53.00174, 53.45542, 53.84992, 53.49487, 53.91896, 54.5699, 54.13594, 
54.08663, 54.21484, 53.49487, 54.11621, 53.80061, 53.33707, 53.70198, 53.96827, 
54.86577, 54.5699, 55.4674, 54.8855, 55.23069, 56.23668, 56.42407, 56.32544, 
55.87176, 56.28599, 55.76327, 55.98025, 55.45753, 56.16764, 56.60159, 55.88162, 
55.41808, 55.56602, 54.12608, 54.48113, 54.91509, 54.60934, 54.32333, 53.7513, 
52.07465, 52.97215, 53.81047, 54.77701, 55.14193, 55.68437, 57.78511, 57.94291, 
58.04154, 58.2881, 59.51107, 59.04752, 57.8936, 57.16376, 57.56813, 58.11057, 
58.12045, 57.70587, 57.68612, 57.71574, 57.98226, 57.35051, 57.16296, 57.98226, 
56.89644, 56.17586, 56.59045, 56.84709, 57.02477, 56.80761, 56.2647, 54.61624, 
52.90856, 49.69061, 49.23655, 51.60559, 52.75062, 52.59269, 52.79011, 50.28287, 
51.08243, 51.12191, 49.93739, 50.98372, 50.22365, 50.4112, 50.44081, 50.32236, 
51.3292, 51.91159, 50.98372, 49.64126, 50.05584, 49.7301, 49.47345, 48.49622, 
49.89791, 48.39751, 48.3679, 48.97003, 49.24642, 49.23655, 50.50004, 50.40133, 
50.65797, 50.98372, 50.7172, 50.61849, 50.54939, 50.06571, 52.28669, 52.0103, 
52.17811, 52.15836, 51.14165, 51.83262, 52.94804, 52.42488, 51.93133, 54.02398, 
53.01622, 52.5321, 53.18418, 53.51022, 53.18418, 53.50034, 55.1997, 55.04162, 
55.13054, 54.24134, 52.81862, 52.5321, 53.04586, 52.84826, 54.32038, 54.39942, 
54.09314, 53.62878, 53.52998, 53.43118, 53.55962, 53.44106, 54.22158, 53.49046, 
52.86802, 54.42906, 53.74734, 52.74946, 52.17642, 52.01834, 50.49681, 50.48693, 
51.8899, 53.25334, 52.20606, 50.59561, 51.16866, 51.38601, 51.99858, 52.07762, 
51.75158, 52.34438, 51.67254, 51.12913, 50.51657, 50.24981, 49.51869, 46.9894, 
45.57656, 46.28792, 46.31756, 44.64784, 44.83556, 41.96047, 41.43683, 40.00423, 
39.66831, 40.56739, 39.0755, 40.01411, 40.07339, 39.95468, 42.12108, 42.02215, 
39.98435, 39.925, 40.35037, 39.43039, 37.40249, 37.10572, 37.0068, 34.60299, 
37.1354, 38.47084, 39.35125, 38.50052, 38.56977, 39.09406, 37.80807, 37.67947, 
38.20376, 39.07427, 38.43127, 40.82519, 41.76496, 42.36838, 42.36838, 42.15075, 
40.60756, 40.70649, 40.92412, 42.52666, 42.2101, 42.13097, 41.77485, 42.38816, 
43.07073, 43.13008, 42.91245, 41.91334, 41.48797, 41.46819, 41.27034, 41.42862, 
41.30002, 42.01226, 41.60668, 41.06261, 41.40884, 39.83597, 40.03382, 40.67681, 
41.44841, 43.77308, 44.49521, 44.43585, 44.62381, 45.1382, 46.23624, 46.09775, 
46.46376, 46.18678, 46.59236, 46.81988, 46.27523, 45.82961, 46.22572, 45.12652, 
44.22538, 43.79956, 43.97781, 43.46287, 44.40362, 44.03723, 43.5718, 42.69046, 
42.73007, 43.27472, 45.4236, 44.62148, 44.46304, 44.671, 45.4137, 46.48319, 
45.66127, 46.12669, 46.11679, 46.48319, 46.5129, 44.94827, 45.29487, 45.09681, 
45.11662, 44.57197, 43.47277, 42.73997, 41.55165, 41.60116, 41.71009, 42.06659, 
42.38348, 42.50231, 42.26465, 44.02732, 39.90781, 38.10552, 40.04644, 41.71009, 
41.97747, 41.75961, 40.38314, 40.66041, 40.88817, 41.57146, 41.87844, 43.01725, 
42.90832, 44.01742, 43.89859, 44.13625, 43.91839, 44.03723, 43.70054, 43.86888, 
43.61141, 43.72034, 43.85898, 43.80929, 43.54095, 43.15334, 42.72598, 43.62045, 
43.57076, 45.43921, 45.67774, 45.61811, 45.17087, 45.44915, 45.30008, 46.1051, 
46.33369, 46.34363, 46.21442, 46.24424, 46.37344, 46.30387, 46.37344, 46.43307, 
46.82068, 46.96975, 47.60583, 47.44681, 47.06914, 47.21822, 46.99957, 47.18841, 
47.4965, 46.88031, 47.4965, 46.63184, 46.46289, 46.79086, 46.12498, 46.30387, 
46.25418, 46.61197, 46.82068, 46.86043, 45.60817, 46.08522, 46.58215, 45.51872, 
46.93994, 46.74117, 47.45675, 48.35122, 48.76864, 48.97735, 49.24569, 48.68913, 
48.40091, 48.17233, 48.31147, 48.30152, 48.68913, 49.17612, 49.27551, 49.26557, 
49.27551, 49.28545, 49.70287, 49.62336, 49.25563, 48.84815, 48.63944, 48.2419, 
48.05244, 48.03249, 49.67778, 49.76753, 51.44273, 53.45697, 52.67919, 54.52391, 
55.29171, 54.47405, 55.29171, 55.30168, 55.38146, 55.93986, 56.52817, 56.61792, 
55.31166, 55.36151, 56.22903, 57.10652, 55.86009, 57.11649, 57.75466, 58.89141, 
59.9783, 59.86861, 59.38001, 59.61933, 59.2803, 60.05807, 59.57944, 59.48969, 
60.62644, 60.57658, 60.31733, 60.8159, 60.91561, 59.86861, 59.2105, 59.26035
)

dow_chemical <- c(
42.48209, 41.16821, 40.50662, 40.44139, 41.44776, 41.38253, 41.14026, 40.63707, 
40.46934, 40.35753, 41.73663, 41.12162, 41.69004, 42.26777, 41.53163, 41.52231, 
41.1589, 40.09661, 41.94163, 42.08141, 42.13732, 43.69347, 43.06915, 44.54144, 
45.10054, 44.97008, 45.19372, 44.80235, 45.79941, 46.06963, 46.19077, 46.04168, 
46.29328, 46.1535, 46.11623, 46.41441, 46.45168, 45.89259, 45.88327, 45.98577, 
45.89259, 46.19077, 45.55713, 44.67189, 44.66257, 43.89847, 43.59097, 44.22461, 
43.84256, 43.82393, 43.4512, 44.29916, 43.54438, 44.0662, 44.01029, 43.99166, 
43.63756, 43.66552, 44.90666, 45.77169, 45.11351, 45.03829, 45.35798, 45.77169, 
45.62125, 45.48021, 45.82811, 45.49902, 45.38619, 45.91273, 47.11626, 46.77777, 
46.69315, 47.09746, 46.68374, 47.03164, 47.95309, 48.06592, 48.39501, 48.7241, 
48.52665, 47.95309, 48.60186, 48.56426, 48.28218, 47.84026, 47.6146, 48.75231, 
48.79932, 47.90608, 47.69922, 48.17875, 48.43262, 47.95309, 47.69922, 47.9907, 
48.31039, 48.22577, 47.59579, 48.14114, 48.48904, 48.95916, 49.13781, 49.50451, 
49.843, 49.88061, 48.95916, 48.32919, 48.44202, 48.88394, 49.04379, 48.74291, 
48.76171, 49.4481, 50.16269, 50.38835, 50.09687, 50.24731, 50.36955, 49.92763, 
50.04046, 49.91725, 48.13551, 48.49565, 48.70415, 48.69467, 47.92701, 48.1829, 
46.93189, 47.63321, 48.72311, 49.22541, 50.26792, 49.37704, 49.50025, 48.49565, 
47.87962, 47.48157, 47.3868, 45.26387, 43.56742, 43.24519, 44.21188, 44.95112, 
44.94164, 44.60046, 44.03181, 44.24979, 44.6668, 44.1645, 43.12199, 44.2024, 
42.92296, 43.31153, 42.61969, 42.55335, 43.09356, 42.41118, 41.82359, 41.38763, 
40.39251, 38.24115, 37.33132, 38.90456, 41.32129, 41.70038, 41.47292, 39.48268, 
40.17453, 40.59153, 39.88073, 41.78568, 41.50136, 41.47292, 41.49188, 40.82847, 
41.33077, 42.62916, 41.90889, 41.04645, 41.71934, 41.32129, 40.3546, 40.2693, 
40.10819, 38.30858, 38.82549, 40.5868, 41.142, 42.54914, 44.3296, 45.06667, 
45.45914, 45.74631, 45.06667, 44.60719, 44.52104, 45.09539, 45.54529, 45.58357, 
45.36341, 45.65058, 45.44956, 47.78522, 48.16811, 48.29255, 48.52229, 49.17321, 
48.72331, 49.46038, 49.3838, 49.75712, 49.18278, 49.40295, 49.62311, 49.4891, 
49.49867, 49.4891, 48.27341, 48.95305, 49.44124, 49.44124, 50.88666, 51.03982, 
51.03982, 50.7335, 51.09725, 49.69969, 49.78584, 49.90071, 51.13554, 50.05387, 
49.64226, 51.03025, 49.80498, 48.72331, 54.53373, 52.56182, 51.08768, 49.09663, 
48.40742, 48.55101, 48.10111, 47.50762, 48.79032, 49.29765, 50.2836, 50.07301, 
49.99643, 50.98149, 49.8902, 49.71637, 48.21947, 47.85249, 46.79983, 45.04218, 
44.69451, 43.84466, 43.25556, 42.1353, 42.7244, 41.48825, 40.62874, 39.90443, 
40.56114, 41.73934, 40.73497, 41.00538, 39.99135, 40.12655, 40.56114, 41.12127, 
43.48733, 45.13875, 45.76648, 45.09046, 44.64622, 45.00355, 44.57862, 43.26521, 
44.43376, 45.22567, 46.34593, 45.94032, 45.46711, 46.24936, 45.37053, 45.57334, 
46.45216, 47.07024, 46.94469, 48.35467, 47.92009, 47.90077, 48.56714, 48.05529, 
47.15715, 47.37927, 47.44688, 48.88583, 48.55748, 48.47056, 48.92446, 49.63911, 
49.8902, 49.77431, 49.49425, 49.42665, 49.56185, 49.79363, 49.81312, 50.16391, 
49.55976, 49.8326, 49.76439, 49.44283, 49.62797, 49.1505, 49.47206, 49.46232, 
50.30033, 50.87525, 51.02142, 51.03116, 51.19681, 51.69378, 50.61215, 50.65113, 
51.26502, 51.19681, 52.29792, 52.22971, 52.05431, 51.26502, 51.304, 50.4465, 
50.07621, 49.55002, 49.85209, 49.54027, 50.22238, 49.93979, 50.22238, 49.25769, 
50.28084, 50.19314, 49.51104, 49.47206, 50.04698, 50.92397, 51.46966, 51.50863, 
50.66088, 50.84602, 50.04698, 50.26136, 50.90449, 51.80096, 52.25895, 52.32716, 
52.30767, 52.21997, 52.01534, 51.34298, 50.7973, 50.5342, 50.85576, 51.57684, 
51.71326, 51.90815, 51.85943, 52.30767, 50.25161, 48.69252, 47.69919, 48.58433, 
48.88921, 48.72202, 47.9549, 47.32547, 47.40415, 48.58433, 49.0269, 50.10874, 
50.33494, 50.9447, 51.20041, 51.73149, 51.49546, 52.07572, 51.63315, 52.24291, 
52.39043, 52.65597, 52.74449, 52.78383, 52.78383, 52.76416, 52.25274, 52.54779, 
52.6068, 52.75432, 52.71498, 52.50845, 52.56746, 52.75432, 51.46596, 51.91836, 
51.49546, 51.77083, 52.35109, 52.53795, 52.61664, 52.89201, 52.72482, 53.12805, 
52.74449, 53.23623, 53.09855, 52.75432, 52.91168, 53.28541, 53.01003, 53.01003, 
53.39359, 52.52812, 52.03638, 51.18074, 51.51513, 51.97737, 51.84951, 52.13472, 
51.70199, 51.86919, 51.69216, 51.37744, 51.26926, 51.70199, 51.92027, 51.32496, 
51.42418, 52.00956, 51.45395, 52.28737, 53.1704, 52.5751, 53.12079, 53.10095, 
52.79338, 52.49573, 52.96205, 52.58502, 53.26962, 53.50774, 53.3986, 53.67641, 
53.81531, 53.68633, 53.33907, 54.13281, 53.49782, 53.38868, 53.35891, 53.18032, 
52.84298, 52.71401, 53.22993, 53.01165, 53.44821, 53.72602, 53.22993, 53.04142, 
52.75369, 52.76361, 52.9422, 52.81322, 53.57719, 53.90461, 53.64664, 53.75578, 
53.89469, 53.56727, 55.28373, 55.67067, 54.98607, 55.62106, 55.77981, 56.45449, 
56.98034, 57.25814, 57.81376, 57.6947, 57.20853, 57.89313, 57.95266, 58.31976, 
58.33961, 58.61742, 58.29, 58.43, 58.42, 57.9, 57.42, 57.22
)
```

```{r}
times <- c(
16437, 16440, 16441, 16442, 16443, 16444, 16447, 16448, 16449, 16450, 16451, 
16455, 16456, 16457, 16458, 16461, 16462, 16463, 16464, 16465, 16468, 16469, 
16470, 16471, 16472, 16475, 16476, 16477, 16478, 16479, 16483, 16484, 16485, 
16486, 16489, 16490, 16491, 16492, 16493, 16496, 16497, 16498, 16499, 16500, 
16503, 16504, 16505, 16506, 16507, 16510, 16511, 16512, 16513, 16514, 16517, 
16518, 16519, 16520, 16521, 16524, 16525, 16526, 16527, 16531, 16532, 16533, 
16534, 16535, 16538, 16539, 16540, 16541, 16542, 16545, 16546, 16547, 16548, 
16549, 16552, 16553, 16554, 16555, 16556, 16559, 16560, 16561, 16562, 16563, 
16566, 16567, 16568, 16569, 16570, 16573, 16574, 16575, 16576, 16577, 16581, 
16582, 16583, 16584, 16587, 16588, 16589, 16590, 16591, 16594, 16595, 16596, 
16597, 16598, 16601, 16602, 16603, 16604, 16605, 16608, 16609, 16610, 16611, 
16612, 16615, 16616, 16617, 16618, 16622, 16623, 16624, 16625, 16626, 16629, 
16630, 16631, 16632, 16633, 16636, 16637, 16638, 16639, 16640, 16643, 16644, 
16645, 16646, 16647, 16650, 16651, 16652, 16653, 16654, 16657, 16658, 16659, 
16660, 16661, 16664, 16665, 16666, 16667, 16668, 16671, 16672, 16673, 16674, 
16675, 16678, 16679, 16680, 16681, 16682, 16686, 16687, 16688, 16689, 16692, 
16693, 16694, 16695, 16696, 16699, 16700, 16701, 16702, 16703, 16706, 16707, 
16708, 16709, 16710, 16713, 16714, 16715, 16716, 16717, 16720, 16721, 16722, 
16723, 16724, 16727, 16728, 16729, 16730, 16731, 16734, 16735, 16736, 16737, 
16738, 16741, 16742, 16743, 16744, 16745, 16748, 16749, 16750, 16751, 16752, 
16755, 16756, 16757, 16758, 16759, 16762, 16763, 16764, 16766, 16769, 16770, 
16771, 16772, 16773, 16776, 16777, 16778, 16779, 16780, 16783, 16784, 16785, 
16786, 16787, 16790, 16791, 16792, 16793, 16797, 16798, 16799, 16800, 16804, 
16805, 16806, 16807, 16808, 16811, 16812, 16813, 16814, 16815, 16819, 16820, 
16821, 16822, 16825, 16826, 16827, 16828, 16829, 16832, 16833, 16834, 16835, 
16836, 16839, 16840, 16841, 16842, 16843, 16847, 16848, 16849, 16850, 16853, 
16854, 16855, 16856, 16857, 16860, 16861, 16862, 16863, 16864, 16867, 16868, 
16869, 16870, 16871, 16874, 16875, 16876, 16877, 16878, 16881, 16882, 16883, 
16884, 16888, 16889, 16890, 16891, 16892, 16895, 16896, 16897, 16898, 16899, 
16902, 16903, 16904, 16905, 16906, 16909, 16910, 16911, 16912, 16913, 16916, 
16917, 16918, 16919, 16920, 16923, 16924, 16925, 16926, 16927, 16930, 16931, 
16932, 16933, 16934, 16937, 16938, 16939, 16940, 16941, 16944, 16945, 16946, 
16947, 16948, 16952, 16953, 16954, 16955, 16958, 16959, 16960, 16961, 16962, 
16965, 16966, 16967, 16968, 16969, 16972, 16973, 16974, 16975, 16976, 16979, 
16980, 16981, 16982, 16983, 16987, 16988, 16989, 16990, 16993, 16994, 16995, 
16996, 16997, 17000, 17001, 17002, 17003, 17004, 17007, 17008, 17009, 17010, 
17011, 17014, 17015, 17016, 17017, 17018, 17021, 17022, 17023, 17024, 17025, 
17028, 17029, 17030, 17031, 17032, 17035, 17036, 17037, 17038, 17039, 17042, 
17043, 17044, 17045, 17046, 17050, 17051, 17052, 17053, 17056, 17057, 17058, 
17059, 17060, 17063, 17064, 17065, 17066, 17067, 17070, 17071, 17072, 17073, 
17074, 17077, 17078, 17079, 17080, 17081, 17084, 17085, 17086, 17087, 17088, 
17091, 17092, 17093, 17094, 17095, 17098, 17099, 17100, 17101, 17102, 17105, 
17106, 17107, 17108, 17109, 17112, 17113, 17114, 17115, 17116, 17119, 17120, 
17121, 17122, 17123, 17126, 17127, 17128, 17130, 17133, 17134, 17135, 17136, 
17137, 17140, 17141, 17142, 17143, 17144, 17147, 17148, 17149, 17150, 17151, 
17154, 17155, 17156, 17157, 17158, 17162, 17163, 17164, 17165
)

# I tried sapply/vapply as.Date - they return vector of ints
# I tried lapply - which gives a list of dates: But unlist turns it into a vector of ints.
#
# ...much wailing and nashing of teeth
#
# Then I found do.call(), which is like a map for lists 
# if you give it the function c, it concatentates the list of dates into a veector of dates.
# lovely...

trade_dates <- do.call("c", lapply(times, as.Date))

class(trade_dates)
length(trade_dates)
```


```{r}
length(yahoo)
length(microsoft)
length(citigroup)
length(dow_chemical)

library(xts)
# date_seq <- seq(from = as.Date("2015-01-02"), to = as.Date("2016-12-30"), by = "days")
# weekday_idx <- wday(date_seq) %in% c(2:6)
# sum(weekday_idx)
# blast this method leaves in public holidays.
# slurp in the data instead

shares <- matrix(c(yahoo, microsoft, citigroup, dow_chemical), nrow = 504)
colnames(shares) <-  c("yahoo", "microsoft", "citigroup", "dow_chemical")
data <- as.xts(shares, order.by = trade_dates)
```

```{r}
# Plot two charts on same graphical window
par(mfrow = c(2,1))
plot(data[, 1], main = "yahoo")
plot(data[, 2], main = "microsoft")

# Replot with reduced margin and character sizes
par(mfrow = c(2,1), mex = 0.6, cex = 0.8)
plot(data[, 1], main = "yahoo")
plot(data[, 2], main = "microsoft")
```

```{r}
# whilst that was an interesting exercise - this teacher has provided the data in their webpage! doh!

# Plot the "microsoft" series
plot(data[ , "microsoft"], main = "Stock prices since 2015")

# Add the "dow_chemical" series in red
lines(data[ , 4], col = "red")

# Add a Y axis on the right side of the chart
axis(side = 4, at = pretty(data[ , "dow_chemical"]))

# Add a legend in the bottom right corner
legend(x = "bottomright",
       legend = c("microsoft", "dow_chemical"),
       col = c("black", "red"),
       lty = c(1, 1))       
```

```{r}
#library(xts)
# Plot the "citigroup" time series
plot(data[,"citigroup"], main = "Citigroup")

# Create vert_line to identify January 4th, 2016 in citigroup
vert_line <- which(index(data[,"citigroup"]) == as.Date("2016-01-04"))

# Add a red vertical line using vert_line
abline(v = .index(data[,"citigroup"])[vert_line], col = "red", lty = 2, l = 3)

# Create hori_line to identify average price of citigroup
hori_line <- mean(data[,"citigroup"])

# Add a blue horizontal line using hori_line
abline(h = hori_line, col = "red")
```

```{r}
library(PerformanceAnalytics)

# Create period to hold the 3 months of 2015
period = c("2015-01/2015-03")

# Highlight the first three months of 2015 
chart.TimeSeries(data[,"citigroup"], period.areas = period)

# Highlight the first three months of 2015 in light grey
 chart.TimeSeries(data[,"citigroup"], period.areas = period, period.color = "lightgrey") 
```

```{r}
# Plot the microsoft series
plot(data[,"microsoft"], main = "Dividend date and amount")

# Add the citigroup series
lines(data[,"citigroup"], col = "orange", lwd = 2)

# Add a new y axis for the citigroup series
axis(side = 4, at = pretty(data[ , "citigroup"]), col = "orange")
```

```{r}
# Same plot as the previous exercise
plot(data$microsoft, main = "Dividend date and amount")
lines(data$citigroup, col = "orange", lwd = 2)
axis(side = 4, at = pretty(data$citigroup), col = "orange")

# Create the two legend strings
micro <- paste0("Microsoft div. of ", "$0.39" ," on ", "15 Nov. 2016")
citi <- paste0("Citigroup div. of ", "$0.16"," on ", "13 Nov. 2016")

# Create the legend in the bottom right corner
legend(x = "bottomright", legend = c(micro, citi), col = c("black", "orange"), lty = c(1, 1))

```








