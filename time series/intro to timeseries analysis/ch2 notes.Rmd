---
title: "R Notebook"
output: html_notebook
---

# Chapter 2

```{r}
# prep data
rapid_growth <- c(
505.9547, 447.3556, 542.5831, 516.0634, 506.9599, 535.0162, 496.9291, 497.5626, 577.2483, 536.856, 541.2459, 473.4978, 550.989, 569.4106, 522.9152, 487.2002, 594.6108, 591.174, 615.9868, 621.3175, 607.125, 587.0367, 554.1554, 644.1172, 509.7, 607.0943, 603.5512, 613.6216, 544.9143, 670.8118, 687.1316, 615.5817, 711.1873, 694.2979, 681.9293, 659.1403, 642.7021, 601.5301, 666.7623, 650.9657, 606.0913, 696.6788, 641.6025, 855.7719, 667.3291, 573.4914, 791.7333, 751.5914, 610.7948, 624.6503, 833.299, 639.8867, 736.8283, 772.2923, 686.8865, 667.7631, 712.9415, 918.1838, 656.1089, 700.4972, 683.4933, 781.738, 715.6843, 808.2875, 820.7795, 656.8856, 733.34, 773.5387, 641.2027, 932.2119, 680.6766, 988.2828, 664.8986, 813.5283, 883.4088, 924.2749, 969.4321, 777.3293, 880.9984, 971.3583, 902.9584, 1020.746, 1075.148, 886.1707, 889.6322, 950.3908, 878.0395, 1043.768, 901.109, 1079.658, 933.9054, 921.9433, 870.8071, 811.1398, 1004.268, 1008.176, 1189.489, 751.9706, 947.4753, 886.5153, 1074.894, 1101.131, 1130.185, 975.8495, 948.161, 1177.823, 1227.127, 976.9957, 836.7089, 1323.605, 852.3532, 1200.826, 1274.479, 1349.261, 1102.633, 1324.857, 1268.719, 1058.229, 1204.087, 1084.65, 1284.431, 1195.284, 1058.426, 1188.058, 1166.593, 1064.695, 1429.069, 1070.853, 1539.331, 1467.157, 1127.706, 1296.072, 1555.274, 1332.904, 1315.424, 1189.246, 1482.434, 1240.929, 1237.772, 1468.608, 1328.546, 1589.508, 1373.163, 1503.556, 1659.938, 1704.614, 1550.464, 1625.803, 1873.858, 1370.621, 1439.711, 1447.437, 1579.916, 1681.257, 1661.606, 1311.847, 1326.031, 1323.1, 1550.486, 1606.204, 1768.54, 1509.837, 1592.109, 1627.619, 1544.633, 1439.523, 1682.352, 1850.71, 1673.38, 1832.427, 1672.267, 1781.577, 1659.29, 1970.039, 2044.712, 1929.09, 1891.704, 1487.158, 2013.872, 1796.789, 1977.018, 1516.955, 1650.604, 1523.283, 1696.618, 1627.261, 1787.297, 1567.287, 1881.996, 2318.983, 1941.988, 1820.28, 2154.812, 2261.547, 2052.221, 2079.171, 2010.061, 2145.261, 1775.301, 2013.407)
cat(rapid_growth)
rapid_growth <- ts(rapid_growth)
ts.plot(rapid_growth)

# Log rapid_growth
linear_growth <- log(rapid_growth)
  
# Plot linear_growth using ts.plot()
ts.plot(linear_growth)

```

```{r}
# > cat(z, sep = ', ')
z <- c(6.226447, 6.103354, 6.296341, 6.24623, 6.228432, 6.282297, 6.208447, 6.209721, 6.358273, 6.28573, 6.293874, 6.160147, 6.311715, 6.344602, 6.259419, 6.188675, 6.387907, 6.38211, 6.423225, 6.431842, 6.408735, 6.375087, 6.317445, 6.467881, 6.233822, 6.408684, 6.402831, 6.419378, 6.300629, 6.508489, 6.532526, 6.422568, 6.566936, 6.542901, 6.524926, 6.490936, 6.465681, 6.399477, 6.502434, 6.478457, 6.407031, 6.546325, 6.463969, 6.752004, 6.503283, 6.351743, 6.674225, 6.622193, 6.414761, 6.437192, 6.725393, 6.461291, 6.602355, 6.649363, 6.532169, 6.503933, 6.569399, 6.822398, 6.486327, 6.55179, 6.527217, 6.66152, 6.573239, 6.694918, 6.710255, 6.48751, 6.597609, 6.650976, 6.463346, 6.83756, 6.523087, 6.895969, 6.499635, 6.701381, 6.783788, 6.82901, 6.87671, 6.655864, 6.781056, 6.878695, 6.805677, 6.928289, 6.980214, 6.78691, 6.790808, 6.856873, 6.777692, 6.950592, 6.803626, 6.9844, 6.839375, 6.826484, 6.76942, 6.69844, 6.912014, 6.915898, 7.081279, 6.622697, 6.853801, 6.787298, 6.979978, 7.004093, 7.030137, 6.883308, 6.854524, 7.071423, 7.112431, 6.884482, 6.729476, 7.188114, 6.748001, 7.090765, 7.150293, 7.207313, 7.005457, 7.18906, 7.145763, 6.964352, 7.093477, 6.989013, 7.158071, 7.086139, 6.964538, 7.080075, 7.061843, 6.970443, 7.264778, 6.976211, 7.339103, 7.291082, 7.027941, 7.167093, 7.349407, 7.195115, 7.181914, 7.081075, 7.301441, 7.123615, 7.121068, 7.292071, 7.19184, 7.37118, 7.224872, 7.315588, 7.414535, 7.441094, 7.346309, 7.393757, 7.535755, 7.223019, 7.272198, 7.27755, 7.365127, 7.427297, 7.41554, 7.179191, 7.189945, 7.187732, 7.346324, 7.381629, 7.47791, 7.319757, 7.372815, 7.394873, 7.342542, 7.272067, 7.427948, 7.523324, 7.422601, 7.513397, 7.421936, 7.485254, 7.414145, 7.585809, 7.623012, 7.564804, 7.545233, 7.304622, 7.607815, 7.493756, 7.589345, 7.32446, 7.408897, 7.328623, 7.436392, 7.394653, 7.48846, 7.357102, 7.540088, 7.748884, 7.571467, 7.506745, 7.675459, 7.723804, 7.626678, 7.639725, 7.60592, 7.671016, 7.481725, 7.607584)

ts.plot(z)

# Generate the first difference of z
dz <- diff(z)
  
# Plot dz
ts.plot(dz)

# View the length of z and dz, respectively
length(z)
length(dz)
```

```{r}
# data prep
# > cat(x, sep = ', ')
x <- c(-4.198033, 9.569009, 5.175143, -9.691646, -3.215294, 10.84367, 6.452159, -10.83356, -2.235351, 10.11983, 6.579646, -8.656565, -2.515001, 9.837434, 7.386194, -8.243504, -4.264033, 8.898861, 8.544336, -8.066913, -4.023025, 9.822679, 7.772852, -6.587777, -3.459171, 10.61385, 7.37445, -5.798715, -1.204711, 11.42924, 7.570047, -4.968384, -2.003787, 11.94135, 9.406672, -4.396585, -1.555579, 12.59988, 8.502916, -3.728968, -2.827, 13.37598, 8.128941, -3.149249, -2.799473, 13.71057, 6.755217, -3.779744, -3.768274, 13.62534, 6.537931, -3.249098, -5.024191, 13.35537, 6.931161, -3.527354, -5.197329, 11.57979, 7.162449, -1.894607, -5.777797, 12.4827, 6.208088, -3.434038, -7.080721, 11.41366, 6.74199, -3.532376, -8.393542, 12.50726, 6.473175, -3.745246, -9.426209, 12.38082, 8.048243, -2.831528, -7.301893, 12.76584, 8.223699, -4.448131, -6.963558, 12.034, 7.574925, -5.402218, -6.568198, 10.89648, 7.276571, -4.037873, -6.723013, 12.18081, 8.285162, -4.159342, -6.36067, 12.75302, 8.665912, -5.440538, -4.874932, 12.6002, 8.162589, -6.539572)

ts.plot(x)

# Generate a diff of x with lag = 4. Save this to dx
dx <- diff(x, lag = 4)
  
# Plot dx
ts.plot(dx)

# View the length of x and dx, respectively 
length(x)
length(dx)
```

```{r}
# Simulate a WN model with list(order = c(0, 0, 0))
white_noise <- arima.sim(model = list(order = c(0, 0, 0)), n = 100)

# Plot your white_noise data
ts.plot(white_noise)

# Simulate from the WN model with: mean = 100, sd = 10
white_noise_2 <- arima.sim(model = list(order = c(0, 0, 0)), n = 100, mean = 100, sd = 10)

# Plot your white_noise_2 data
ts.plot(white_noise_2)
```

```{r}
# prep data
#> cat(y, sep = ', ')
y <- c(109.7613, 98.3161, 100.6329, 88.7434, 101.8724, 104.6284, 96.64462, 102.8619, 112.7625, 82.23219, 88.94434, 94.60318, 105.6111, 113.8278, 104.8232, 101.2963, 82.98459, 88.96058, 100.6005, 91.03525, 100.1929, 95.32537, 94.58643, 121.3583, 87.37874, 96.89007, 90.5131, 99.90843, 102.5693, 104.9614, 104.7346, 88.00465, 100.7794, 121.6478, 85.77083, 79.15428, 98.18847, 99.90006, 98.91084, 101.6442, 102.7953, 84.65112, 96.4787, 105.8155, 98.51869, 105.2437, 109.6126, 85.14201, 82.81442, 103.0363, 93.56967, 98.08922, 81.25461, 109.1855, 80.43181, 103.5595, 80.22269, 84.97477, 107.7836, 92.61288, 99.80293, 107.2508, 98.66378, 91.92275, 98.32642, 112.734, 96.02811, 92.64909, 83.08484, 97.22196, 106.6136, 97.36943, 108.7847, 104.9186, 84.44343, 85.60786, 96.51529, 94.18105, 85.02851, 63.26622, 87.22137, 103.523, 105.6022, 103.2604, 101.1152, 108.457, 97.67631, 103.0108, 100.6176, 105.5811, 98.72722, 98.43996, 90.78219, 92.74599, 102.9376, 83.95306, 110.1594, 104.1758, 99.27876, 103.2511)
y <- ts(y)

# Fit the WN model to y using the arima command
arima(y, order = c(0,0,0))

# Calculate the sample mean and sample variance of y
mean(y)
var(y)

```

```{r}
# Generate a RW model using arima.sim
random_walk <- arima.sim(model = list(order = c(0, 1, 0)), n = 100)

# Plot random_walk
ts.plot(random_walk)

# Calculate the first difference series
random_walk_diff <- diff(random_walk)

# Plot random_walk_diff
ts.plot(random_walk_diff)
  
```

```{r}
# Generate a RW model with a drift uing arima.sim
rw_drift <- arima.sim(model = list(order = c(0, 1, 0)), n = 100, mean = 1)

# Plot rw_drift
ts.plot(rw_drift)

# Calculate the first difference series
rw_drift_diff <- diff(rw_drift)

# Plot rw_drift_diff
ts.plot(rw_drift_diff)

```

```{r}
# prep data
random_walk <- c(0, 0.8407997, 0.6374594, 0.7579217, 0.5118742, 0.1137669, 0.2789728, 0.2775946, 0.6030589, 2.912096, 3.181991, 2.551573, 3.267562, 4.999799, 7.109158, 8.010709, 8.237725, 8.701572, 9.051261, 13.32007, 12.16758, 11.53243, 12.2601, 12.57678, 12.66326, 12.72567, 13.19948, 12.83965, 13.50619, 15.48168, 16.17711, 16.83653, 16.61634, 16.18083, 16.96627, 16.72703, 17.65618, 20.89016, 20.05676, 22.41686, 23.16283, 22.91684, 21.9327, 22.65475, 23.63257, 24.86377, 25.53588, 27.22257, 27.37216, 29.01976, 30.86984, 32.48599, 33.18834, 33.79983, 32.77184, 33.32934, 36.0168, 36.44585, 38.23885, 39.11572, 38.79921, 39.22752, 37.56901, 40.08821, 40.53808, 40.75786, 41.5757, 41.1068, 41.10646, 40.64553, 39.55549, 40.43122, 41.96042, 43.68665, 45.23504, 45.90246, 47.54046, 49.09718, 48.91702, 48.07963, 46.77653, 47.97751, 46.43342, 45.94536, 47.07275, 47.189, 51.29253, 52.12474, 51.37968, 52.12705, 51.22302, 52.6302, 52.42624, 51.35647, 52.20179, 53.38172, 55.02444, 55.93036, 55.51172, 58.30803, 58.11833)

ts.plot(random_walk)

# Difference your random_walk data
rw_diff <- diff(random_walk)

# Plot rw_diff
ts.plot(rw_diff)

# Now fit the WN model to the differenced data
model_wn <- arima(x = rw_diff, order = c(0,0,0))

# Store the value of the estimated time trend (intercept)
int_wn <- model_wn$coef

# Plot the original random_walk data
ts.plot(random_walk)

# Use abline(0, ...) to add time trend to the figure
abline(0,int_wn)

```

```{r}
# Use arima.sim() to generate WN data
white_noise <- arima.sim(model = list(order = c(0,0,0)), n = 100 )

# Use cumsum() to convert your WN data to RW
random_walk <- cumsum(white_noise)
  
# Use arima.sim() to generate WN drift data
wn_drift <- arima.sim(model = list(order = c(0,0,0)), n = 100, mean = 0.4)
  
# Use cumsum() to convert your WN drift data to RW
rw_drift <- cumsum(wn_drift)

# Plot all four data objects
plot.ts(cbind(white_noise, random_walk, wn_drift, rw_drift))
```







