---
title: "R Notebook"
output: html_notebook
---

# Chapter 2


```{r}
eu_stocks <- EuStockMarkets

# Plot eu_stocks
plot(eu_stocks)

# Use this code to convert prices to returns
returns <- eu_stocks[-1,] / eu_stocks[-1860,] - 1

# Convert returns to ts
returns <- ts(returns, start = c(1991, 130), frequency = 260)

# Plot returns
plot(returns)

# Use this code to convert prices to log returns
logreturns <- diff(log(eu_stocks))

# Plot logreturns
plot(logreturns)

```


```{r}
# prep data
eu_percentreturns <- returns * 100

# Generate means from eu_percentreturns
colMeans(eu_percentreturns)

# Use apply to calculate sample variance from eu_percentreturns
apply(eu_percentreturns, MARGIN = 2, FUN = var)

# Use apply to calculate standard deviation from eu_percentreturns
apply(eu_percentreturns, MARGIN = 2, FUN = sd)

# Display a histogram of percent returns for each index
par(mfrow = c(2,2))
apply(eu_percentreturns, MARGIN = 2, FUN = hist, main = "", xlab = "Percentage Return")

# Display normal quantile plots of percent returns for each index
par(mfrow = c(2,2))
apply(eu_percentreturns, MARGIN = 2, FUN = qqnorm, main = "")
qqline(eu_percentreturns)

```

```{r}
# Make a scatterplot of DAX and FTSE
plot(eu_stocks[,1], eu_stocks[,4])

# Make a scatterplot matrix of eu_stocks
pairs(eu_stocks)

# Convert eu_stocks to log returns
logreturns <- diff(log(eu_stocks))

# Plot logreturns
plot(logreturns)

# Make a scatterplot matrix of logreturns
pairs(logreturns)

```

```{r}
# prep data
DAX_logreturns <- logreturns[,1]
FTSE_logreturns <- logreturns[,4]

# Use cov() with DAX_logreturns and FTSE_logreturns
cov(DAX_logreturns, FTSE_logreturns)

# Use cov() with logreturns
cov(logreturns)

# Use cor() with DAX_logreturns and FTSE_logreturns
cor(DAX_logreturns, FTSE_logreturns)

# Use cor() with logreturns
cor(logreturns)

```

```{r}
x <- c(2.065544, 1.299638, 0.033578, -0.3425807, 0.2325613, 0.4681201, 4.341116, 2.820076, 2.908, 2.334951, 1.1599, 0.8200866, -0.2433893, -0.03355907, -1.535482, -0.693638, -1.417316, -0.7662318, 0.8353606, 0.04395345, 1.074475, 1.502004, -0.2123861, 0.3299652, -0.7503347, -0.1052204, 0.2047192, -0.171706, 0.8718138, 1.472137, 0.8411259, 0.9643016, 0.6682903, -0.2575269, 0.08193916, -1.46057, -1.267268, -2.193292, -2.210089, 0.4233895, -1.015139, -1.544462, -0.7252404, 0.7035238, -0.3610846, -0.7742209, -0.500236, 1.313694, 1.156217, 0.6878237, -0.7947518, 0.3256332, 2.009556, 1.706143, 0.9991064, 0.6893271, 0.6576426, 1.514035, 0.8580641, 1.969513, 2.982683, 3.017813, 1.300097, 0.7114022, 0.4078291, -0.534298, -0.2114725, 1.728144, -0.7554166, -1.341788, -1.72317, -2.781478, -1.725725, -3.494661, -2.417894, -0.1374425, -0.1580531, -0.2786536, -0.974935, -1.526666, -1.040931, -1.260597, -1.44067, -1.239026, -0.4466817, 1.125629, 3.255185, 1.135705, 0.9899241, 0.3824427, 2.711246, 2.422169, 1.7851, -1.030921, -1.066073, -2.634653, -2.668082, -1.304114, -1.042699, 0.4021526, -0.4892825, -0.4938147, -1.084577, -0.2745695, -1.843909, -2.099076, -1.889236, -1.845343, -0.3381216, -1.209117, -0.501577, -0.5829873, -1.665759, -1.413278, -2.553803, -0.8689529, -2.16915, -2.602026, -2.056782, -0.8765411, 1.329197, 1.07621, -0.964327, -1.8148, -2.057576, -2.343534, -0.01467163, 0.7732145, 0.03106214, 1.169996, 2.677323, 4.577617, 4.90583, 4.133004, 4.043981, 1.350813, 0.6142904, 1.42969, 0.7923115, 1.341781, 2.220166, 2.825023, 2.432793, 1.890234, 0.468774, -1.306806, -1.459106, 0.2116933, 1.102034, 1.423606)

x <- ts(x)
n <- length(x)

# Define x_t0 as x[-1]
x_t0 <- x[-1]

# Define x_t1 as x[-n]
x_t1 <- x[-n]

# Confirm that x_t0 and x_t1 are (x[t], x[t-1]) pairs  
head(cbind(x_t0, x_t1))
  
# Plot x_t0 and x_t1
plot(x_t0, x_t1)

# View the correlation between x_t0 and x_t1
cor(x_t0, x_t1)

# Use acf with x
acf(x, lag.max = 1, plot = FALSE)

# Confirm that difference factor is (n-1)/n
cor(x_t1, x_t0) * (n-1)/n

```

```{r}
# Generate ACF estimates for x up to lag-10
acf(x, lag.max = 10, plot = FALSE)

# Type the ACF estimate at lag-10 
0.100

# Type the ACF estimate at lag-5
0.198

```

```{r}
# prep data
x<-c(
  -0.0371945, -0.6774337, -0.7346274, -1.530753, -2.270475, -1.966438, -0.9642172, -0.5254676, -0.8943894, -0.5885773, 1.173991, 0.2372143, 0.4953394, 0.4510699, -0.07493236, 0.3944475, 1.693748, 0.1289142, -0.3778379, 0.6834055, 1.725439, 1.441053, 0.6011691, 0.05699473, 0.06582289, -1.115338, -0.6377188, -2.108545, -1.634415, -0.9738792, -3.366324, -3.008531, -4.468204, -4.133151, -5.63799, -5.004451, -3.228336, -2.90165, -2.652244, -2.294641, -3.405547, -2.195885, -0.02022387, 0.00810997, -1.067319, -0.5862661, 0.3617761, -0.7914878, -0.7243043, -0.2375602, -0.006248334, -0.8871769, -1.354322, -2.612806, -1.703891, -0.9672987, 0.4072381, 1.216422, 2.584759, 4.094657, 1.3229, 2.30104, 1.051198, 1.034542, 0.3281929, -0.2544074, 0.1153659, -0.09550107, -1.29116, -2.43527, -0.3402219, -0.1612461, -0.1938562, 0.0130285, 0.6699881, 0.2583376, 0.4080975, 0.6346525, 0.7872179, 0.2108624, 0.5712237, 1.451819, 1.149417, 3.409951, 0.3294953, 0.494241, -0.7823097, -1.250713, -2.174555, -1.332113, -0.2579807, 0.696177, 1.802775, 1.13365, 0.3408994, 1.205502, 2.517728, 1.459119, -0.07664063, -1.048398, 0.4591945, -0.1192162, 0.01902597, 0.4814569, 0.5298255, 3.183669, 2.544619, 3.263691, 1.888815, 1.813037, 0.1515052, -0.5887887, 0.6899315, -0.7204308, -0.857841, -1.287169, -1.528267, -1.20655, -2.332676, -2.767497, -3.079378, -1.889327, -1.804903, -1.724744, -2.020249, -1.884501, -1.856917, -0.5692461, 0.4504226, -0.684973, 0.1441279, -0.4585341, -0.7163896, 0.009236847, -0.2692218, 0.4075512, 1.515129, 1.917949, 2.316384, 0.8636596, 0.8677358, -0.2444124, -1.637805, -2.34618, -0.9336626, -0.7028431, -1.651374, -1.455613, -0.1657455, -0.3295202
)
y<-c(
  -1.363121, -2.007064, 1.458622, 5.735961, -0.6038233, -1.294575, 1.26073, 5.438339, -1.158564, -2.092377, 1.030416, 5.791997, -0.528572, 0.4994546, 0.936981, 4.712188, 2.557306, 1.318724, 2.033195, 4.46472, 1.995398, 1.539936, -0.41051, 4.891242, 0.4817101, 2.582473, -0.7632721, 5.176552, 0.5692751, 3.997787, 0.4793219, 3.461933, -0.7424117, 3.581696, -1.834319, 3.307288, 0.8936998, 4.39326, -0.5347452, 3.215408, 0.6049578, 4.754216, 0.3639881, 2.099483, 2.121385, 4.177273, 1.052707, 2.481302, 3.878023, 4.343234, 2.662682, 1.743587, 6.083051, 4.762191, 1.743551, 2.017151, 6.512928, 5.345223, 0.6326728, 3.04333, 5.872307, 4.106172, 0.1431763, 2.81641, 5.296144, 3.717681, 1.703102, 2.251832, 4.088232, 3.576238, 1.083734, 0.5924662, 2.830025, 3.03414, 1.844974, 0.2548238, 3.194788, 1.867072, 0.6080342, 2.624457, 3.10411, 2.170159, -0.08714403, 3.0589, 3.751025, 1.832164, 0.9329121, 4.722822, 2.820838, 1.331986, 0.239624, 4.433118, 3.374422, 0.9280016, 2.10145, 4.942583, 3.517209, 1.841848, 0.5822267, 4.262144, 2.347233, 0.1225283, 0.03479805, 5.625523, 4.225202, 0.6948933, 0.8461168, 6.523418, 2.926155, 0.7664312, 0.2416456, 5.072125, 2.15603, 0.5690797, -1.051876, 4.850235, 1.204409, 2.729162, 0.8284433, 1.481367, -1.803176, 2.222588, 0.8163767, 1.572005, -1.601205, 0.09871604, 1.693734, 1.615175, -2.158362, 0.2723635, 1.636204, 1.477044, -2.183051, 0.7216468, 1.85063, 0.8143965, -1.248028, 0.4961948, 2.982467, 1.452116, -1.672834, 0.2293648, 2.828051, 2.407309, -0.04598149, 1.626222, 5.610247, 2.944894, -0.7706812, 0.4437879
)
z<-c(
  0.315738, 1.735436, -0.009264601, 0.8136288, -0.9285601, -1.15311, 0.8628037, 0.5312867, -1.165747, -1.812795, 1.612365, 0.02719756, -0.4414481, 0.5215157, 0.6695942, 0.6605425, -0.6027687, 0.3106521, -0.4946789, -1.10656, 0.5709864, -1.001931, 0.2571652, 0.329057, -1.938901, -0.8566351, -1.363199, -0.57161, 0.8053028, -0.4962444, 0.1736293, -0.5040157, 0.1311102, 0.420892, -0.2292869, -0.5784476, -0.4693452, 0.3640042, -0.865851, 0.4226781, 0.4638332, -0.7922818, -0.7642701, -0.5504182, 0.5664275, 0.1453995, 0.4827295, 0.4748848, -0.1699093, 1.205351, 0.7755579, -0.03346979, 0.1178926, 0.2336056, 0.1273796, 0.949563, 0.4479227, -0.9589778, 1.425275, 0.5019502, -2.396123, 0.04668375, -0.1676888, 0.6634821, 0.1813273, 0.2200068, -1.990311, 1.079237, -0.8677026, 0.6860756, 0.4815514, -2.11252, 1.367934, 1.464156, 0.07157914, 0.3023937, -1.100968, 0.1160536, -0.0425502, 0.1372783, 0.3615697, -0.1924878, -0.3051125, 3.129498, -0.3782001, 0.7167233, -0.7111381, 0.1810782, 0.6889588, 0.8156271, -0.7992531, 0.04446238, 0.5404327, -0.6216673, 0.5446085, -0.3652836, -0.7591976, -1.492074, -1.170489, -1.567303, -1.612972, 1.254711, -0.3223669, 1.430948, -0.3156138, 0.1660291, 0.1944908, -0.7994526, -1.251505, -2.430422, 0.1798066, -0.3075393, 0.5043496, -0.4421376, -0.3637538, -2.189015, 0.5258419, -0.4848556, 0.2112115, -0.09713511, -0.9655491, 0.01600681, -0.05998641, -0.1554691, 0.1008953, 0.06193285, -0.7345588, -0.3183351, 1.038486, 1.085413, 0.6905016, 0.8596168, 0.4324529, 1.346334, 1.928117, 0.01478253, 0.9712312, 0.3049376, -0.7715935, -1.538397, -1.304015, -0.6401256, 1.133903, 0.02973662, 0.7387968, 1.92534, 0.9882898, 1.009784, -0.2135033, 1.477742
)

# View the ACF of x
acf(x)

# View the ACF of y
acf(y)

# View the ACF of z
acf(z)

```











